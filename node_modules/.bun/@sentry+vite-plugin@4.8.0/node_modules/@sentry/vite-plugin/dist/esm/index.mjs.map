{"version":3,"file":"index.mjs","sources":["../../src/index.ts"],"sourcesContent":["import {\n  CodeInjection,\n  sentryUnpluginFactory,\n  Options,\n  createRollupInjectionHooks,\n  createRollupDebugIdUploadHooks,\n  SentrySDKBuildFlags,\n  createRollupBundleSizeOptimizationHooks,\n  createComponentNameAnnotateHooks,\n  Logger,\n} from \"@sentry/bundler-plugin-core\";\nimport { UnpluginOptions, VitePlugin } from \"unplugin\";\n\nfunction viteInjectionPlugin(injectionCode: CodeInjection, debugIds: boolean): UnpluginOptions {\n  return {\n    name: \"sentry-vite-injection-plugin\",\n    // run `post` to avoid tripping up @rollup/plugin-commonjs when cjs is used\n    // as we inject an `import` statement\n    enforce: \"post\" as const, // need this so that vite runs the resolveId hook\n    vite: createRollupInjectionHooks(injectionCode, debugIds),\n  };\n}\n\nfunction viteComponentNameAnnotatePlugin(\n  ignoredComponents: string[],\n  injectIntoHtml: boolean\n): UnpluginOptions {\n  return {\n    name: \"sentry-vite-component-name-annotate-plugin\",\n    enforce: \"pre\" as const,\n    vite: createComponentNameAnnotateHooks(ignoredComponents, injectIntoHtml),\n  };\n}\n\nfunction viteDebugIdUploadPlugin(\n  upload: (buildArtifacts: string[]) => Promise<void>,\n  logger: Logger,\n  createDependencyOnBuildArtifacts: () => () => void\n): UnpluginOptions {\n  return {\n    name: \"sentry-vite-debug-id-upload-plugin\",\n    vite: createRollupDebugIdUploadHooks(upload, logger, createDependencyOnBuildArtifacts),\n  };\n}\n\nfunction viteBundleSizeOptimizationsPlugin(\n  replacementValues: SentrySDKBuildFlags\n): UnpluginOptions {\n  return {\n    name: \"sentry-vite-bundle-size-optimizations-plugin\",\n    vite: createRollupBundleSizeOptimizationHooks(replacementValues),\n  };\n}\n\nconst sentryUnplugin = sentryUnpluginFactory({\n  injectionPlugin: viteInjectionPlugin,\n  componentNameAnnotatePlugin: viteComponentNameAnnotatePlugin,\n  debugIdUploadPlugin: viteDebugIdUploadPlugin,\n  bundleSizeOptimizationsPlugin: viteBundleSizeOptimizationsPlugin,\n});\n\nexport const sentryVitePlugin = (options?: Options): VitePlugin[] => {\n  const result = sentryUnplugin.vite(options);\n  // unplugin returns a single plugin instead of an array when only one plugin is created, so we normalize this here.\n  return Array.isArray(result) ? result : [result];\n};\n\nexport type { Options as SentryVitePluginOptions } from \"@sentry/bundler-plugin-core\";\nexport { sentryCliBinaryExists } from \"@sentry/bundler-plugin-core\";\n"],"names":["viteInjectionPlugin","injectionCode","debugIds","name","enforce","vite","createRollupInjectionHooks","viteComponentNameAnnotatePlugin","ignoredComponents","injectIntoHtml","createComponentNameAnnotateHooks","viteDebugIdUploadPlugin","upload","logger","createDependencyOnBuildArtifacts","createRollupDebugIdUploadHooks","viteBundleSizeOptimizationsPlugin","replacementValues","createRollupBundleSizeOptimizationHooks","sentryUnplugin","sentryUnpluginFactory","injectionPlugin","componentNameAnnotatePlugin","debugIdUploadPlugin","bundleSizeOptimizationsPlugin","sentryVitePlugin","options","result","Array","isArray"],"mappings":";;;AAaA,SAASA,mBAAmBA,CAACC,aAA4B,EAAEC,QAAiB,EAAmB;EAC7F,OAAO;AACLC,IAAAA,IAAI,EAAE,8BAA8B;AACpC;AACA;AACAC,IAAAA,OAAO,EAAE,MAAe;AAAE;AAC1BC,IAAAA,IAAI,EAAEC,0BAA0B,CAACL,aAAa,EAAEC,QAAQ,CAAA;GACzD,CAAA;AACH,CAAA;AAEA,SAASK,+BAA+BA,CACtCC,iBAA2B,EAC3BC,cAAuB,EACN;EACjB,OAAO;AACLN,IAAAA,IAAI,EAAE,4CAA4C;AAClDC,IAAAA,OAAO,EAAE,KAAc;AACvBC,IAAAA,IAAI,EAAEK,gCAAgC,CAACF,iBAAiB,EAAEC,cAAc,CAAA;GACzE,CAAA;AACH,CAAA;AAEA,SAASE,uBAAuBA,CAC9BC,MAAmD,EACnDC,MAAc,EACdC,gCAAkD,EACjC;EACjB,OAAO;AACLX,IAAAA,IAAI,EAAE,oCAAoC;AAC1CE,IAAAA,IAAI,EAAEU,8BAA8B,CAACH,MAAM,EAAEC,MAAM,EAAEC,gCAAgC,CAAA;GACtF,CAAA;AACH,CAAA;AAEA,SAASE,iCAAiCA,CACxCC,iBAAsC,EACrB;EACjB,OAAO;AACLd,IAAAA,IAAI,EAAE,8CAA8C;IACpDE,IAAI,EAAEa,uCAAuC,CAACD,iBAAiB,CAAA;GAChE,CAAA;AACH,CAAA;AAEA,IAAME,cAAc,GAAGC,qBAAqB,CAAC;AAC3CC,EAAAA,eAAe,EAAErB,mBAAmB;AACpCsB,EAAAA,2BAA2B,EAAEf,+BAA+B;AAC5DgB,EAAAA,mBAAmB,EAAEZ,uBAAuB;AAC5Ca,EAAAA,6BAA6B,EAAER,iCAAAA;AACjC,CAAC,CAAC,CAAA;IAEWS,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAIC,OAAiB,EAAmB;AACnE,EAAA,IAAMC,MAAM,GAAGR,cAAc,CAACd,IAAI,CAACqB,OAAO,CAAC,CAAA;AAC3C;EACA,OAAOE,KAAK,CAACC,OAAO,CAACF,MAAM,CAAC,GAAGA,MAAM,GAAG,CAACA,MAAM,CAAC,CAAA;AAClD;;;;"}