#!/usr/bin/env node
import {b as b$1,a as a$1}from'./chunk-UOTHKX3D.js';import {b,P,o,S,$,t,e,Z,Q,q,j,r,k,u,c as c$1,da,fa,h,i,f,g,s,O,d,ca,a,L,ma,N,na,ia,ga,ja,K,ka,M,R as R$1,oa,la,T as T$1,l,ea,p,G,X,A,Y as Y$1,n as n$1,U as U$1,m,V as V$1,H as H$1,J,I,W}from'./chunk-F67Q5GTR.js';export{ia as fetchTree,ja as getItemTargetPath,na as getPreset,ma as getPresets,ka as getRegistries,ba as getRegistriesConfig,la as getRegistriesIndex,_ as getRegistry,ga as getRegistryBaseColor,fa as getRegistryBaseColors,ea as getRegistryIcons,$ as getRegistryItems,da as getRegistryStyles,ca as getShadcnRegistryIndex,aa as resolveRegistryItems,ha as resolveTree}from'./chunk-F67Q5GTR.js';import {c,o as o$1,n}from'./chunk-BZ3ASCNT.js';import {e as e$1}from'./chunk-VSDIRB3U.js';import'./chunk-RKTXGSVI.js';import*as E from'path';import E__default,{join}from'path';import {promises,existsSync}from'fs';import R from'fs-extra';import S$1 from'postcss';import wi from'postcss/lib/at-rule';import ut,{z}from'zod';import {execa}from'execa';import _e from'prompts';import {SyntaxKind,Project,ScriptKind,VariableDeclarationKind}from'ts-morph';import it,{tmpdir}from'os';import {Command}from'commander';import vr from'deepmerge';import*as Y from'fs/promises';import Y__default from'fs/promises';import ft from'dedent';import Tr from'open';import jn from'validate-npm-package-name';import {diffLines}from'diff';import {StdioServerTransport}from'@modelcontextprotocol/sdk/server/stdio.js';import {randomBytes}from'crypto';import bt from'fast-glob';async function nr(e$1){let t$1={};if(!R.existsSync(e$1.cwd)||!R.existsSync(E__default.resolve(e$1.cwd,"package.json")))return t$1["1"]=true,{errors:t$1,projectInfo:null};let r=u("Preflight checks.",{silent:e$1.silent}).start();R.existsSync(E__default.resolve(e$1.cwd,"components.json"))&&!e$1.force&&(r?.fail(),t.break(),t.error(`A ${e.info("components.json")} file already exists at ${e.info(e$1.cwd)}.
To start over, remove the ${e.info("components.json")} file and run ${e.info("init")} again.`),t.break(),process.exit(1)),r?.succeed();let i=u("Verifying framework.",{silent:e$1.silent}).start(),n=await q(e$1.cwd);(!n||n?.framework.name==="manual")&&(t$1["7"]=true,i?.fail(),t.break(),n?.framework.links.installation&&t.error(`We could not detect a supported framework at ${e.info(e$1.cwd)}.
Visit ${e.info(n?.framework.links.installation)} to manually configure your project.
Once configured, you can use the cli to add components.`),t.break(),process.exit(1)),i?.succeed(`Verifying framework. Found ${e.info(n.framework.label)}.`);let o="Validating Tailwind CSS.";n.tailwindVersion==="v4"&&(o=`Validating Tailwind CSS config. Found ${e.info("v4")}.`);let a=u(o,{silent:e$1.silent}).start();n.tailwindVersion==="v3"&&(!n?.tailwindConfigFile||!n?.tailwindCssFile)?(t$1["5"]=true,a?.fail()):n.tailwindVersion==="v4"&&!n?.tailwindCssFile?(t$1["5"]=true,a?.fail()):n.tailwindVersion?a?.succeed():(t$1["5"]=true,a?.fail());let s=u("Validating import alias.",{silent:e$1.silent}).start();return n?.aliasPrefix?s?.succeed():(t$1["6"]=true,s?.fail()),Object.keys(t$1).length>0&&(t$1["5"]&&(t.break(),t.error(`No Tailwind CSS configuration found at ${e.info(e$1.cwd)}.`),t.error("It is likely you do not have Tailwind CSS installed or have an invalid configuration."),t.error("Install Tailwind CSS then try again."),n?.framework.links.tailwind&&t.error(`Visit ${e.info(n?.framework.links.tailwind)} to get started.`)),t$1["6"]&&(t.break(),t.error("No import alias found in your tsconfig.json file."),n?.framework.links.installation&&t.error(`Visit ${e.info(n?.framework.links.installation)} to learn how to set an import alias.`)),t.break(),process.exit(1)),{errors:t$1,projectInfo:n}}function or(e,t){if(e.includes("\0"))return  false;let r;try{r=e;let g="";for(;r!==g&&r.includes("%");)g=r,r=decodeURIComponent(r);}catch{return  false}let i=E__default.normalize(r.replace(/\\/g,"/")),n=E__default.normalize(t),o=g=>g.replace(/\[\.\.\..*?\]/g,"").includes("..");if(o(i)||o(r)||o(e))return  false;let a=g=>g.replace(/\[\.\.\..*?\]/g,""),s=a(e),c=a(r);if([/\.\.[\/\\]/,/[\/\\]\.\./,/\.\./,/\.\.%/,/\x00/,/[\x01-\x1f]/].some(g=>g.test(s)||g.test(c))||(e.includes("~")||r.includes("~"))&&(e.includes("../")||r.includes("../")))return  false;if(/^[a-zA-Z]:[\/\\]/.test(r))return process.platform==="win32"?r.toLowerCase().startsWith(t.toLowerCase()):false;if(E__default.isAbsolute(i))return i.startsWith(n+E__default.sep);let p=E__default.resolve(n,i);return p.startsWith(n+E__default.sep)||p===n}async function Xe(e$1,t,r){if(!t.resolvedPaths.tailwindCss||!e$1||Object.keys(e$1).length===0)return;r={silent:false,...r};let i=t.resolvedPaths.tailwindCss,n=E__default.relative(t.resolvedPaths.cwd,i),o=u(`Updating ${e.info(n)}`,{silent:r.silent}).start(),a=await promises.readFile(i,"utf8"),s=await ui(a,e$1);await promises.writeFile(i,s,"utf8"),o.succeed();}async function ui(e,t){let r=[gi(t)],i=await S$1(r).process(e,{from:void 0}),n=i.css,o=i.root;if(o.nodes&&o.nodes.length>0){let a=o.nodes[o.nodes.length-1];a.type==="atrule"&&!a.nodes&&!n.trimEnd().endsWith(";")&&(n=n.trimEnd()+";");}return n=n.replace(/\/\* ---break--- \*\//g,""),n=n.replace(/(\n\s*\n)+/g,`

`),n=n.trimEnd(),n}function gi(e){return {postcssPlugin:"update-css",Once(t){for(let[r,i]of Object.entries(e))if(r.startsWith("@")){let n=r.match(/@([a-zA-Z-]+)\s*(.*)/);if(!n)continue;let[,o,a]=n;if(o==="import"){if(!t.nodes?.find(c=>c.type==="atrule"&&c.name==="import"&&c.params===a)){let c=S$1.atRule({name:"import",params:a,raws:{semicolon:true}}),m=t.nodes?.filter(l=>l.type==="atrule"&&l.name==="import");if(m&&m.length>0){let l=m[m.length-1];c.raws.before=`
`,t.insertAfter(l,c);}else !t.nodes||t.nodes.length,c.raws.before="",t.prepend(c);}}else if(o==="plugin"){let s=a;a&&!a.startsWith('"')&&!a.startsWith("'")&&(s=`"${a}"`);let c=l=>l.startsWith('"')&&l.endsWith('"')||l.startsWith("'")&&l.endsWith("'")?l.slice(1,-1):l;if(!t.nodes?.find(l=>l.type!=="atrule"||l.name!=="plugin"?false:c(l.params)===c(a))){let l=S$1.atRule({name:"plugin",params:s,raws:{semicolon:true,before:`
`}}),p=t.nodes?.filter(w=>w.type==="atrule"&&w.name==="import"),g=t.nodes?.filter(w=>w.type==="atrule"&&w.name==="plugin");if(g&&g.length>0){let w=g[g.length-1];t.insertAfter(w,l);}else if(p&&p.length>0){let w=p[p.length-1];t.insertAfter(w,l),t.insertBefore(l,S$1.comment({text:"---break---"})),t.insertAfter(l,S$1.comment({text:"---break---"}));}else t.prepend(l),t.insertBefore(l,S$1.comment({text:"---break---"})),t.insertAfter(l,S$1.comment({text:"---break---"}));}}else if(typeof i=="object"&&Object.keys(i).length===0){if(!t.nodes?.find(c=>c.type==="atrule"&&c.name===o&&c.params===a)){let c=S$1.atRule({name:o,params:a,raws:{semicolon:true}});t.append(c),t.insertBefore(c,S$1.comment({text:"---break---"}));}}else if(o==="keyframes"){let s=t.nodes?.find(l=>l.type==="atrule"&&l.name==="theme"&&l.params==="inline");s||(s=S$1.atRule({name:"theme",params:"inline",raws:{semicolon:true,between:" ",before:`
`}}),t.append(s),t.insertBefore(s,S$1.comment({text:"---break---"})));let c=s.nodes?.find(l=>l.type==="atrule"&&l.name==="keyframes"&&l.params===a),m;if(c?(m=S$1.atRule({name:"keyframes",params:a,raws:{semicolon:true,between:" ",before:`
  `}}),c.replaceWith(m)):(m=S$1.atRule({name:"keyframes",params:a,raws:{semicolon:true,between:" ",before:`
  `}}),s.append(m)),typeof i=="object")for(let[l,p]of Object.entries(i))te(m,l,p);}else if(o==="utility"){let s=t.nodes?.find(c=>c.type==="atrule"&&c.name===o&&c.params===a);if(s){if(typeof i=="object")for(let[c,m]of Object.entries(i))if(typeof m=="string"){let l=s.nodes?.find(g=>g.type==="decl"&&g.prop===c),p=S$1.decl({prop:c,value:m,raws:{semicolon:true,before:`
    `}});l?l.replaceWith(p):s.append(p);}else typeof m=="object"&&te(s,c,m);}else {let c=S$1.atRule({name:o,params:a,raws:{semicolon:true,between:" ",before:`
`}});if(t.append(c),t.insertBefore(c,S$1.comment({text:"---break---"})),typeof i=="object")for(let[m,l]of Object.entries(i))if(typeof l=="string"){let p=S$1.decl({prop:m,value:l,raws:{semicolon:true,before:`
    `}});c.append(p);}else typeof l=="object"&&te(c,m,l);}}else o==="property"?te(t,r,i):ar(t,o,a,i);}else te(t,r,i);}}}function ar(e,t,r,i){let n=e.nodes?.find(o=>o.type==="atrule"&&o.name===t&&o.params===r);if(n||(n=S$1.atRule({name:t,params:r,raws:{semicolon:true,between:" ",before:`
`}}),e.append(n),e.insertBefore(n,S$1.comment({text:"---break---"}))),typeof i=="object")for(let[o,a]of Object.entries(i))if(o.startsWith("@")){let s=o.match(/@([a-zA-Z-]+)\s*(.*)/);if(s){let[,c,m]=s;ar(n,c,m,a);}}else te(n,o,a);else if(typeof i=="string")try{let a=S$1.parse(`.temp{${i}}`).first;if(a&&a.nodes){let s=S$1.rule({selector:"temp",raws:{semicolon:!0,between:" ",before:`
  `}});a.nodes.forEach(c=>{if(c.type==="decl"){let m=c.clone();m.raws.before=`
    `,s.append(m);}}),s.nodes?.length&&n.append(s);}}catch(o){throw console.error("Error parsing at-rule content:",i,o),o}}function te(e,t,r){let i=e.nodes?.find(n=>n.type==="rule"&&n.selector===t);if(i||(i=S$1.rule({selector:t,raws:{semicolon:true,between:" ",before:`
  `}}),e.append(i)),typeof r=="object"){for(let[n,o]of Object.entries(r))if(n.startsWith("@")&&typeof o=="object"&&o!==null&&Object.keys(o).length===0){let a=n.match(/@([a-zA-Z-]+)\s*(.*)/);if(a){let[,s,c]=a,m=S$1.atRule({name:s,params:c,raws:{semicolon:true,before:`
    `}});i.append(m);}}else if(typeof o=="string"){let a=S$1.decl({prop:n,value:o,raws:{semicolon:true,before:`
    `}}),s=i.nodes?.find(c=>c.type==="decl"&&c.prop===n);s?s.replaceWith(a):i.append(a);}else if(typeof o=="object"){let a=n.startsWith("&")?t.replace(/^([^:]+)/,`$1${n.substring(1)}`):n;te(e,a,o);}}else if(typeof r=="string")try{let o=S$1.parse(`.temp{${r}}`).first;o&&o.nodes&&o.nodes.forEach(a=>{if(a.type==="decl"){let s=a.clone();s.raws.before=`
    `,i?.append(s);}});}catch(n){throw console.error("Error parsing rule content:",t,r,n),n}}async function Qe(e$1,t,r){if(!t.resolvedPaths.tailwindCss||!Object.keys(e$1??{}).length)return;r={cleanupDefaultNextStyles:false,silent:false,tailwindVersion:"v3",overwriteCssVars:false,initIndex:true,...r};let i=t.resolvedPaths.tailwindCss,n=E__default.relative(t.resolvedPaths.cwd,i),o=u(`Updating CSS variables in ${e.info(n)}`,{silent:r.silent}).start(),a=await promises.readFile(i,"utf8"),s=await yi(a,e$1??{},t,{cleanupDefaultNextStyles:r.cleanupDefaultNextStyles,tailwindVersion:r.tailwindVersion,tailwindConfig:r.tailwindConfig,overwriteCssVars:r.overwriteCssVars,initIndex:r.initIndex});await promises.writeFile(i,s,"utf8"),o.succeed();}async function yi(e,t,r,i={cleanupDefaultNextStyles:false,tailwindVersion:"v3",tailwindConfig:void 0,overwriteCssVars:false,initIndex:false}){i={cleanupDefaultNextStyles:false,tailwindVersion:"v3",tailwindConfig:void 0,overwriteCssVars:false,initIndex:false,...i};let n=[xi(t)];if(i.cleanupDefaultNextStyles&&n.push(mr()),i.tailwindVersion==="v4"){if(n=[],r.resolvedPaths?.cwd){let s=p(r.resolvedPaths.cwd);!s?.dependencies?.["tailwindcss-animate"]&&!s?.devDependencies?.["tailwindcss-animate"]&&i.initIndex&&n.push(Ii({params:"tw-animate-css"}));}n.push(Ci({params:"dark (&:is(.dark *))"})),i.cleanupDefaultNextStyles&&n.push(mr()),n.push(Si(t,{overwriteCssVars:i.overwriteCssVars})),n.push(Ri(t)),i.tailwindConfig&&(n.push(ki(i.tailwindConfig)),n.push(ji(i.tailwindConfig)),n.push(Pi(i.tailwindConfig)));}r.tailwind.cssVariables&&i.initIndex&&n.push(bi({tailwindVersion:i.tailwindVersion}));let a=(await S$1(n).process(e,{from:void 0})).css;return a=a.replace(/\/\* ---break--- \*\//g,""),i.tailwindVersion==="v4"&&(a=a.replace(/(\n\s*\n)+/g,`

`)),a}function bi({tailwindVersion:e}){return {postcssPlugin:"update-base-layer",Once(t){let r=[{selector:"*",apply:e==="v4"?"border-border outline-ring/50":"border-border"},{selector:"body",apply:"bg-background text-foreground"}],i=t.nodes.find(n=>n.type==="atrule"&&n.name==="layer"&&n.params==="base"&&r.every(({selector:o,apply:a})=>n.nodes?.some(s=>s.type==="rule"&&s.selector===o&&s.nodes.some(c=>c.type==="atrule"&&c.name==="apply"&&c.params===a))));i||(i=S$1.atRule({name:"layer",params:"base",raws:{semicolon:true,between:" ",before:`
`}}),t.append(i),t.insertBefore(i,S$1.comment({text:"---break---"}))),r.forEach(({selector:n,apply:o})=>{i?.nodes?.find(s=>s.type==="rule"&&s.selector===n)||i?.append(S$1.rule({selector:n,nodes:[S$1.atRule({name:"apply",params:o,raws:{semicolon:true,before:`
    `}})],raws:{semicolon:true,between:" ",before:`
  `}}));});}}}function xi(e){return {postcssPlugin:"update-css-vars",Once(t){let r=t.nodes.find(i=>i.type==="atrule"&&i.name==="layer"&&i.params==="base");r instanceof wi||(r=S$1.atRule({name:"layer",params:"base",nodes:[],raws:{semicolon:true,before:`
`,between:" "}}),t.append(r),t.insertBefore(r,S$1.comment({text:"---break---"}))),r!==void 0&&Object.entries(e).forEach(([i,n])=>{let o=i==="light"?":root":`.${i}`;vi(r,o,n);});}}}function lr(e){let t=e.nodes.find(r=>r.type==="rule"&&r.selector===":root");if(t){let r=["--background","--foreground"];t.nodes.filter(i=>i.type==="decl"&&r.includes(i.prop)).forEach(i=>i.remove()),t.nodes.length===0&&t.remove();}}function mr(){return {postcssPlugin:"cleanup-default-next-styles",Once(e){let t=e.nodes.find(i=>i.type==="rule"&&i.selector==="body");t&&(t.nodes.find(i=>i.type==="decl"&&i.prop==="color"&&["rgb(var(--foreground-rgb))","var(--foreground)"].includes(i.value))?.remove(),t.nodes.find(i=>i.type==="decl"&&i.prop==="background"&&(i.value.startsWith("linear-gradient")||i.value==="var(--background)"))?.remove(),t.nodes.find(i=>i.type==="decl"&&i.prop==="font-family"&&i.value==="Arial, Helvetica, sans-serif")?.remove(),t.nodes.length===0&&t.remove()),lr(e);let r=e.nodes.find(i=>i.type==="atrule"&&i.params==="(prefers-color-scheme: dark)");r&&(lr(r),r.nodes.length===0&&r.remove());}}}function vi(e,t,r){let i=e.nodes?.find(n=>n.type==="rule"&&n.selector===t);i||Object.keys(r).length>0&&(i=S$1.rule({selector:t,raws:{between:" ",before:`
  `}}),e.append(i)),Object.entries(r).forEach(([n,o])=>{let a=`--${n.replace(/^--/,"")}`,s=S$1.decl({prop:a,value:o,raws:{semicolon:true}}),c=i?.nodes.find(m=>m.type==="decl"&&m.prop===a);c?c.replaceWith(s):i?.append(s);});}function Si(e,t){return {postcssPlugin:"update-css-vars-v4",Once(r){Object.entries(e).forEach(([i,n])=>{let o=i==="light"?":root":`.${i}`;if(i==="theme"){o="@theme";let s=$e(r);Object.entries(n).forEach(([c,m])=>{let l=`--${c.replace(/^--/,"")}`,p=S$1.decl({prop:l,value:m,raws:{semicolon:true}}),g=s?.nodes?.find(w=>w.type==="decl"&&w.prop===l);t.overwriteCssVars?g?g.replaceWith(p):s?.append(p):g||s?.append(p);});return}let a=r.nodes?.find(s=>s.type==="rule"&&s.selector===o);!a&&Object.keys(n).length>0&&(a=S$1.rule({selector:o,nodes:[],raws:{semicolon:true,between:" ",before:`
`}}),r.append(a),r.insertBefore(a,S$1.comment({text:"---break---"}))),Object.entries(n).forEach(([s,c])=>{let m=`--${s.replace(/^--/,"")}`;m==="--sidebar-background"&&(m="--sidebar"),fr(c)&&(c=`hsl(${c})`);let l=S$1.decl({prop:m,value:c,raws:{semicolon:true}}),p=a?.nodes.find(g=>g.type==="decl"&&g.prop===m);t.overwriteCssVars?p?p.replaceWith(l):a?.append(l):p||a?.append(l);});});}}}function Ri(e){return {postcssPlugin:"update-theme",Once(t){let r=Array.from(new Set(Object.keys(e).flatMap(o=>Object.keys(e[o]||{}))));if(!r.length)return;let i=$e(t),n=i.nodes?.filter(o=>o.type==="decl"&&o.prop.startsWith("--"));for(let o of r){let a=Object.values(e).find(p=>p[o])?.[o];if(!a)continue;if(o==="radius"){let p={sm:"calc(var(--radius) - 4px)",md:"calc(var(--radius) - 2px)",lg:"var(--radius)",xl:"calc(var(--radius) + 4px)","2xl":"calc(var(--radius) + 8px)","3xl":"calc(var(--radius) + 12px)","4xl":"calc(var(--radius) + 16px)"};for(let[g,w]of Object.entries(p)){let u=S$1.decl({prop:`--radius-${g}`,value:w,raws:{semicolon:true}});i?.nodes?.find(h=>h.type==="decl"&&h.prop===u.prop)||i?.append(u);}continue}let s=fr(a)||$i(a)?`--color-${o.replace(/^--/,"")}`:`--${o.replace(/^--/,"")}`;s==="--color-sidebar-background"&&(s="--color-sidebar");let c=`var(--${o})`;s==="--color-sidebar"&&(c="var(--sidebar)");let m=S$1.decl({prop:s,value:c,raws:{semicolon:true}});i?.nodes?.find(p=>p.type==="decl"&&p.prop===m.prop)||(n?.length?i?.insertAfter(n[n.length-1],m):i?.append(m));}}}}function $e(e){let t=e.nodes.find(r=>r.type==="atrule"&&r.name==="theme"&&r.params==="inline");return t||(t=S$1.atRule({name:"theme",params:"inline",nodes:[],raws:{semicolon:true,between:" ",before:`
`}}),e.append(t),e.insertBefore(t,S$1.comment({text:"---break---"}))),t}function Ci({params:e}){return {postcssPlugin:"add-custom-variant",Once(t){if(!t.nodes.find(i=>i.type==="atrule"&&i.name==="custom-variant")){let i=t.nodes.filter(o=>o.type==="atrule"&&o.name==="import"),n=S$1.atRule({name:"custom-variant",params:e,raws:{semicolon:true,before:`
`}});if(i.length>0){let o=i[i.length-1];t.insertAfter(o,n);}else t.insertAfter(t.nodes[0],n);t.insertBefore(n,S$1.comment({text:"---break---"}));}}}}function Ii({params:e}){return {postcssPlugin:"add-custom-import",Once(t){let r=t.nodes.filter(o=>o.type==="atrule"&&o.name==="import"),i=t.nodes.find(o=>o.type==="atrule"&&o.name==="custom-variant");if(!r.some(o=>o.params.replace(/["']/g,"")===e)){let o=S$1.atRule({name:"import",params:`"${e}"`,raws:{semicolon:true,before:`
`}});if(r.length>0){let a=r[r.length-1];t.insertAfter(a,o);}else i?(t.insertBefore(i,o),t.insertBefore(i,S$1.comment({text:"---break---"}))):(t.prepend(o),t.insertAfter(o,S$1.comment({text:"---break---"})));}}}}function ki(e){return {postcssPlugin:"update-tailwind-config",Once(t){if(!e?.plugins)return;let i=Ei(t)==="single"?"'":'"',n=t.nodes.filter(a=>a.type==="atrule"&&a.name==="plugin"),o=n[n.length-1]||t.nodes[0];for(let a of e.plugins){let s=a.replace(/^require\(["']|["']\)$/g,"");if(n.some(m=>m.params.replace(/["']/g,"")===s))continue;let c=S$1.atRule({name:"plugin",params:`${i}${s}${i}`,raws:{semicolon:true,before:`
`}});t.insertAfter(o,c),t.insertBefore(c,S$1.comment({text:"---break---"}));}}}}function Pi(e){return {postcssPlugin:"update-tailwind-config-keyframes",Once(t){if(!e?.theme?.extend?.keyframes)return;let r=$e(t),i=r.nodes?.filter(o=>o.type==="atrule"&&o.name==="keyframes"),n=z.record(z.string(),z.record(z.string(),z.string()));for(let[o,a]of Object.entries(e.theme.extend.keyframes)){if(typeof o!="string")continue;let s=n.safeParse(a);if(!s.success||i?.find(m=>m.type==="atrule"&&m.name==="keyframes"&&m.params===o))continue;let c=S$1.atRule({name:"keyframes",params:o,nodes:[],raws:{semicolon:true,between:" ",before:`
  `}});for(let[m,l]of Object.entries(s.data)){let p=S$1.rule({selector:m,nodes:Object.entries(l).map(([g,w])=>S$1.decl({prop:g,value:w,raws:{semicolon:true,before:`
      `,between:": "}})),raws:{semicolon:true,between:" ",before:`
    `}});c.append(p);}r.append(c),r.insertBefore(c,S$1.comment({text:"---break---"}));}}}}function ji(e){return {postcssPlugin:"update-tailwind-config-animation",Once(t){if(!e?.theme?.extend?.animation)return;let r=$e(t),i=r.nodes?.filter(o=>o.type==="decl"&&o.prop.startsWith("--animate-")),n=z.record(z.string(),z.string()).safeParse(e.theme.extend.animation);if(n.success)for(let[o,a]of Object.entries(n.data)){let s=`--animate-${o}`;if(i?.find(m=>m.prop===s))continue;let c=S$1.decl({prop:s,value:a,raws:{semicolon:true,between:": ",before:`
  `}});r.append(c);}}}}function Ei(e){return e.nodes[0].toString().includes("'")?"single":"double"}function fr(e){if(e.startsWith("hsl")||e.startsWith("rgb")||e.startsWith("#")||e.startsWith("oklch"))return  false;let t=e.split(" ");return t.length===3&&t.slice(1,3).every(r=>r.includes("%"))}function $i(e){return e.startsWith("hsl")||e.startsWith("rgb")||e.startsWith("#")||e.startsWith("oklch")||e.includes("--color-")}async function U(e,t$1,r,i){if(e=Array.from(new Set(e)),t$1=Array.from(new Set(t$1)),!e?.length&&!t$1?.length)return;i={silent:false,...i};let n=u("Installing dependencies.",{silent:i.silent})?.start(),o=await Ti(r),a="";if(Oi(r)&&o==="npm")if(i.silent)a="force";else {n.stopAndPersist(),t.warn(`
It looks like you are using React 19. 
Some packages may fail to install due to peer dependency issues in npm (see https://ui.shadcn.com/react-19).
`);let s=await _e([{type:"select",name:"flag",message:"How would you like to proceed?",choices:[{title:"Use --force",value:"force"},{title:"Use --legacy-peer-deps",value:"legacy-peer-deps"}]}]);s&&(a=s.flag);}n?.start(),await Fi(o,e,t$1,r.resolvedPaths.cwd,a),n?.succeed();}function Oi(e){let t=p(e.resolvedPaths.cwd,false);if(!t?.dependencies?.react)return  false;let r=/^(?:\^|~)?19(?:\.\d+)*(?:-.*)?$/.test(t.dependencies.react),i=t.dependencies["react-day-picker"]?.startsWith("8");return r&&i}async function Ti(e){return p(e.resolvedPaths.cwd,false)?.dependencies?.expo?"expo":a$1(e.resolvedPaths.cwd)}async function Fi(e,t,r,i,n){if(e==="npm")return Ai(t,r,i,n);if(e==="deno")return _i(t,r,i);if(e==="expo")return Di(t,r,i);t?.length&&await execa(e,["add",...t],{cwd:i}),r?.length&&await execa(e,["add","-D",...r],{cwd:i});}async function Ai(e,t,r,i){e.length&&await execa("npm",["install",...i?[`--${i}`]:[],...e],{cwd:r}),t.length&&await execa("npm",["install",...i?[`--${i}`]:[],"-D",...t],{cwd:r});}async function _i(e,t,r){e?.length&&await execa("deno",["add",...e.map(i=>`npm:${i}`)],{cwd:r}),t?.length&&await execa("deno",["add","-D",...t.map(i=>`npm:${i}`)],{cwd:r});}async function Di(e,t,r){e.length&&await execa("npx",["expo","install",...e],{cwd:r}),t.length&&await execa("npx",["expo","install","-- -D",...t],{cwd:r});}async function et(e$1,t$1,r){if(!e$1||Object.keys(e$1).length===0)return {envVarsAdded:[],envFileUpdated:null,envFileCreated:null};r={silent:false,...r};let i=u("Adding environment variables.",{silent:r.silent})?.start(),n=t$1.resolvedPaths.cwd,o=E__default.join(n,".env.local"),a=H$1(n);a&&(o=a);let s=existsSync(o),c=E__default.basename(o),m=Object.entries(e$1).map(([w,u])=>`${w}=${u}`).join(`
`),l=[],p=null,g=null;if(s){let w=await promises.readFile(o,"utf-8"),u=J(w,m);if(l=I(w,m),l.length>0){if(await promises.writeFile(o,u,"utf-8"),p=E__default.relative(n,o),i?.succeed(`Added the following variables to ${e.info(c)}:`),!r.silent)for(let h of l)t.log(`  ${e.success("+")} ${h}`);}else i?.stop();}else if(await promises.writeFile(o,m+`
`,"utf-8"),g=E__default.relative(n,o),l=Object.keys(e$1),i?.succeed(`Added the following variables to ${e.info(c)}:`),!r.silent)for(let w of l)t.log(`  ${e.success("+")} ${w}`);return !r.silent&&l.length>0&&t.break(),{envVarsAdded:l,envFileUpdated:p,envFileCreated:g}}async function dr(e,t){if(!e.fonts?.length)return e;let r=await q(t.resolvedPaths.cwd);if(!r)return e;let[i]=e.fonts;if(e.cssVars??={},e.cssVars.theme??={},r.framework.name==="next-app"||r.framework.name==="next-pages")return e.cssVars.theme[i.font.variable]=`var(${i.font.variable})`,e;let o=`@fontsource-variable/${i.name.replace("font-","")}`;return e.dependencies??=[],e.dependencies.push(o),e.css??={},e.css[`@import "${o}"`]={},e.css["@layer base"]??={},e.css["@layer base"].html={"@apply font-sans":{}},e.css["@layer base"].body={"@apply font-sans bg-background text-foreground":{}},e.cssVars.theme[i.font.variable]=i.font.family,e}async function tt(e,t,r){if(!e?.length)return;let i=await q(t.resolvedPaths.cwd);if(!i||i.framework.name!=="next-app"&&i.framework.name!=="next-pages")return;let n=u("Updating fonts.",{silent:r.silent})?.start();try{await Bi(e,t,i),n?.succeed("Updating fonts.");}catch(o){throw n?.fail("Failed to update fonts."),o}}async function Bi(e,t,r){let i=await Gi(t,r);if(!i)return;let n=await promises.readFile(i,"utf-8"),o=await Ji(n,e);o!==n&&await promises.writeFile(i,o,"utf-8");}async function Gi(e,t){let r=e.resolvedPaths.cwd,i=t.isSrcDir,o=t.isTsx?"tsx":"jsx",a=i?[`src/app/layout.${o}`,`app/layout.${o}`]:[`app/layout.${o}`];for(let s of a){let c=E__default.join(r,s);if(existsSync(c))return c}return null}async function Ji(e,t,r){let n=new Project({compilerOptions:{}}).createSourceFile("layout.tsx",e,{scriptKind:ScriptKind.TSX}),o=t.filter(s=>s.font.provider==="google"),a=[];for(let s of o){let c=s.font.import;if(!c)continue;let m=n.getImportDeclaration(w=>w.getModuleSpecifierValue()==="next/font/google");if(m){if(m.getNamedImports().some(h=>h.getName()===c))continue;m.addNamedImport(c);}else n.addImportDeclaration({moduleSpecifier:"next/font/google",namedImports:[c]});let l=Ki(c),p=Yi(s),g=qi(n,s.font.variable);if(g)g.setInitializer(`${c}(${p})`),g.getName()!==l&&g.rename(l);else {let w=Hi(n);n.insertVariableStatement(w,{declarationKind:VariableDeclarationKind.Const,declarations:[{name:l,initializer:`${c}(${p})`}]}).appendWhitespace(`
`);}a.push(l);}return a.length>0&&Xi(n,a),n.getFullText()}function Yi(e){let t={};return e.font.subsets?.length&&(t.subsets=e.font.subsets),e.font.weight?.length&&(t.weight=e.font.weight),t.variable=e.font.variable,JSON.stringify(t).replace(/"([^"]+)":/g,"$1:").replace(/"/g,"'")}function Ki(e){return e.split("_").map((t,r)=>r===0?t.toLowerCase():t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join("")}function qi(e,t){let r=e.getVariableStatements();for(let i of r)for(let n of i.getDeclarations()){let o=n.getInitializer();if(!o||o.getKind()!==SyntaxKind.CallExpression)continue;let s=o.getArguments();if(s.length===0)continue;let c=s[0].getText();if(c.includes("variable:")&&c.includes(t))return n}return null}function Hi(e){let t=e.getImportDeclarations();return t.length>0?t[t.length-1].getChildIndex()+1:0}function Xi(e,t){let r=e.getDescendantsOfKind(SyntaxKind.JsxOpeningElement);for(let i of r){if(i.getTagNameNode().getText()!=="html")continue;let o=i.getAttribute("className");if(!o){let m=t.map(l=>`${l}.variable`).join(", ");t.length===1?i.addAttribute({name:"className",initializer:`{${m}}`}):(he(e),i.addAttribute({name:"className",initializer:`{cn(${m})}`}));return}if(o.getKind()!==SyntaxKind.JsxAttribute)return;let a=o.asKindOrThrow(SyntaxKind.JsxAttribute),s=a.getInitializer();if(!s)return;let c=t.map(m=>`${m}.variable`);if(s.getKind()===SyntaxKind.StringLiteral){let m=s.getText().slice(1,-1);he(e),a.setInitializer(`{cn("${m}", ${c.join(", ")})}`);}else if(s.getKind()===SyntaxKind.JsxExpression){let m=s.asKindOrThrow(SyntaxKind.JsxExpression),l=m.getExpression();if(!l)return;let p=l.getText();if(p.startsWith("cn(")){if(c.every(h=>p.includes(h)))continue;let w=Zi(p),u=en(w,c);m.replaceWithText(`{${u}}`);}else if(/^\w+\.variable$/.test(p)){if(c.includes(p))continue;c.length===1?m.replaceWithText(`{${c[0]}}`):(he(e),m.replaceWithText(`{cn(${c.join(", ")})}`));}else if(p.startsWith("`")&&p.endsWith("`")){let g=Qi(p);he(e),m.replaceWithText(`{cn(${[...g,...c].join(", ")})}`);}else he(e),m.replaceWithText(`{cn(${p}, ${c.join(", ")})}`);}}}function he(e){if(!e.getImportDeclaration(r=>r.getNamedImports().some(n=>n.getName()==="cn"))){let r=e.getImportDeclaration(i=>i.getModuleSpecifierValue().includes("/lib/utils"));r?r.getNamedImports().some(n=>n.getName()==="cn")||r.addNamedImport("cn"):e.addImportDeclaration({moduleSpecifier:"@/lib/utils",namedImports:["cn"]});}}function Qi(e){let t=[],r=[],n=e.slice(1,-1).split(/(\$\{[^}]+\})/);for(let o of n)if(o)if(o.startsWith("${")&&o.endsWith("}")){let a=o.slice(2,-1).trim();a&&r.push(a);}else {let a=o.trim().split(/\s+/).filter(Boolean);for(let s of a)t.push(`"${s}"`);}return [...t,...r]}function Zi(e){return e.replace(/,?\s*\w+\.variable/g,"").replace(/cn\(\s*,/,"cn(")}function en(e,t){let r=t.join(", ");return e.replace(/\)$/,`, ${r})`)}async function ie(e,t,r){r={overwrite:false,silent:false,isNewProject:false,baseStyle:true,...r};let i=await l(t);return i&&i.ui&&i.ui.resolvedPaths.cwd!==t.resolvedPaths.cwd?await nn(e,t,i,{...r,isRemote:e?.length===1&&!!e[0].match(/\/chat\/b\//)}):await rn(e,t,r)}async function rn(e,t$1,r){if(!r.baseStyle&&!e.length)return;let i=u("Checking registry.",{silent:r.silent})?.start(),n=await Y$1(e,P(t$1));if(!n)return i?.fail(),Z(new Error("Failed to fetch components from registry."));try{gr(n.files??[],t$1.resolvedPaths.cwd);}catch(s){return i?.fail(),Z(s)}i?.succeed();let o=await s(t$1);n=await dr(n,t$1),await U$1(n.tailwind?.config,t$1,{silent:r.silent,tailwindVersion:o});let a=await ur(e,t$1);await Qe(n.cssVars,t$1,{cleanupDefaultNextStyles:r.isNewProject,silent:r.silent,tailwindVersion:o,tailwindConfig:n.tailwind?.config,overwriteCssVars:a,initIndex:r.baseStyle}),await Xe(n.css,t$1,{silent:r.silent}),await et(n.envVars,t$1,{silent:r.silent}),await U(n.dependencies,n.devDependencies,t$1,{silent:r.silent}),await tt(n.fonts,t$1,{silent:r.silent}),await L(n.files,t$1,{overwrite:r.overwrite,silent:r.silent,path:r.path}),n.docs&&t.info(n.docs);}async function nn(e,t$1,r,i){if(!i.baseStyle&&!e.length)return;let n=u("Checking registry.",{silent:i.silent})?.start(),o=await Y$1(e,P(t$1));if(!o)return n?.fail(),Z(new Error("Failed to fetch components from registry."));try{gr(o.files??[],t$1.resolvedPaths.cwd);}catch(h){return n?.fail(),Z(h)}n?.succeed();let a=[],s$1=[],c=[],m$1=u("Installing components.")?.start(),l=r.ui,p=await s(l),g=n$1(t$1.resolvedPaths.cwd,l.resolvedPaths.ui);if(o.tailwind?.config&&(await U$1(o.tailwind?.config,l,{silent:true,tailwindVersion:p}),s$1.push(E__default.relative(g,l.resolvedPaths.tailwindConfig))),o.cssVars){let h=await ur(e,t$1);await Qe(o.cssVars,l,{silent:true,tailwindVersion:p,tailwindConfig:o.tailwind?.config,overwriteCssVars:h}),s$1.push(E__default.relative(g,l.resolvedPaths.tailwindCss));}o.css&&(await Xe(o.css,l,{silent:true}),s$1.push(E__default.relative(g,l.resolvedPaths.tailwindCss))),o.envVars&&await et(o.envVars,l,{silent:true}),await U(o.dependencies,o.devDependencies,l,{silent:true}),await tt(o.fonts,l,{silent:true});let w=new Map;for(let h of o.files??[]){let b=h.type||"registry:ui";w.has(b)||w.set(b,[]),w.get(b).push(h);}for(let h of Array.from(w.keys())){let b=w.get(h),v=h==="registry:ui"?r.ui:t$1,W=n$1(t$1.resolvedPaths.cwd,v.resolvedPaths.ui||v.resolvedPaths.cwd),F=await m(W,v.resolvedPaths.cwd)??v.resolvedPaths.cwd,X=await L(b,v,{overwrite:i.overwrite,silent:true,rootSpinner:m$1,isRemote:i.isRemote,isWorkspace:true,path:i.path});a.push(...X.filesCreated.map(A=>E__default.relative(W,E__default.join(F,A)))),s$1.push(...X.filesUpdated.map(A=>E__default.relative(W,E__default.join(F,A)))),c.push(...X.filesSkipped.map(A=>E__default.relative(W,E__default.join(F,A))));}if(m$1?.succeed(),a.sort(),s$1.sort(),c.sort(),!(a.length||s$1.length)&&!c.length&&u("No files updated.",{silent:i.silent})?.info(),a.length){u(`Created ${a.length} ${a.length===1?"file":"files"}:`,{silent:i.silent})?.succeed();for(let h of a)t.log(`  - ${h}`);}if(s$1.length){u(`Updated ${s$1.length} ${s$1.length===1?"file":"files"}:`,{silent:i.silent})?.info();for(let h of s$1)t.log(`  - ${h}`);}if(c.length){u(`Skipped ${c.length} ${s$1.length===1?"file":"files"}: (use --overwrite to overwrite)`,{silent:i.silent})?.info();for(let h of c)t.log(`  - ${h}`);}o.docs&&t.info(o.docs);}async function ur(e,t){let r=await $(e,{config:t});return z.array(n).parse(r).some(n=>n.type==="registry:theme"||n.type==="registry:style"||n.type==="registry:font"||n.type==="registry:base")}function gr(e,t){for(let r of e)if(r?.target&&!or(r.target,t))throw new Error(`We found an unsafe file path "${r.target} in the registry item. Installation aborted.`)}var nt="https://codeload.github.com/shadcn-ui/ui/tar.gz/main",V={next:"next","next-monorepo":"next-monorepo",vite:"vite",start:"start"};async function Oe(e$1){e$1={srcDir:false,...e$1};let t$1=e$1.template&&V[e$1.template]?e$1.template:"next",r=e$1.name??(t$1===V.next||t$1===V.vite||t$1===V.start?"my-app":"my-monorepo"),i="latest",n=e$1.components?.length===1&&!!e$1.components[0].match(/\/chat\/b\//);if(e$1.components&&n)try{let[s]=await T$1(e$1.components),{meta:c}=z.object({meta:z.object({nextVersion:z.string()})}).parse(s);i=c.nextVersion,t$1=V.next;}catch(s){t.break(),Z(s);}if(!e$1.force){let{type:s,name:c}=await _e([{type:e$1.template||n?null:"select",name:"type",message:`The path ${e.info(e$1.cwd)} does not contain a package.json file.
  Would you like to start a new project?`,choices:[{title:"Next.js",value:"next"},{title:"Next.js (Monorepo)",value:"next-monorepo"},{title:"Vite",value:"vite"},{title:"TanStack Start",value:"start"}],initial:0},{type:e$1.name?null:"text",name:"name",message:"What is your project named?",initial:r,format:m=>m.trim(),validate:m=>m.length>128?"Name should be less than 128 characters.":true}]);t$1=s??t$1,r=c??r;}let o=await a$1(e$1.cwd,{withFallback:true}),a=`${e$1.cwd}/${r}`;try{await R.access(e$1.cwd,R.constants.W_OK);}catch{t.break(),t.error(`The path ${e.info(e$1.cwd)} is not writable.`),t.error(`It is likely you do not have write permissions for this folder or the path ${e.info(e$1.cwd)} does not exist.`),t.break(),process.exit(1);}return R.existsSync(E__default.resolve(e$1.cwd,r,"package.json"))&&(t.break(),t.error(`A project with the name ${e.info(r)} already exists.`),t.error("Please choose a different name and try again."),t.break(),process.exit(1)),t$1===V.next&&await sn(a,{version:i,cwd:e$1.cwd,packageManager:o,srcDir:!!e$1.srcDir}),t$1===V["next-monorepo"]&&await an(a,{packageManager:o}),t$1===V.vite&&await cn(a,{packageManager:o}),t$1===V.start&&await ln(a,{packageManager:o}),{projectPath:a,projectName:r,template:t$1}}async function sn(e,t$1){let r=u("Creating a new Next.js project. This may take a few minutes.").start(),i=["--tailwind","--eslint","--typescript","--app",t$1.srcDir?"--src-dir":"--no-src-dir","--no-import-alias",`--use-${t$1.packageManager}`];(t$1.version.startsWith("15")||t$1.version.startsWith("latest")||t$1.version.startsWith("canary"))&&i.push("--turbopack"),(t$1.version.startsWith("latest")||t$1.version.startsWith("canary"))&&i.push("--no-react-compiler");try{await execa("npx",[`create-next-app@${t$1.version}`,e,"--silent",...i],{cwd:t$1.cwd});}catch{t.break(),t.error("Something went wrong creating a new Next.js project. Please try again."),process.exit(1);}r?.succeed("Creating a new Next.js project.");}async function an(e,t){let r=u("Creating a new Next.js monorepo. This may take a few minutes.").start();try{let i=E__default.join(it.tmpdir(),`shadcn-template-${Date.now()}`);await R.ensureDir(i);let n=await fetch(nt);if(!n.ok)throw new Error(`Failed to download template: ${n.statusText}`);let o=E__default.resolve(i,"template.tar.gz");await R.writeFile(o,Buffer.from(await n.arrayBuffer())),await execa("tar",["-xzf",o,"-C",i,"--strip-components=2","ui-main/templates/monorepo-next"]);let a=E__default.resolve(i,"monorepo-next");await R.move(a,e),await R.remove(i),await execa(t.packageManager,["install"],{cwd:e});let s=E__default.join(e,"package.json");if(R.existsSync(s)){let m=await R.readFile(s,"utf8"),l=JSON.parse(m);l.name=e.split("/").pop(),await R.writeFile(s,JSON.stringify(l,null,2));}let c=process.cwd();await execa("git",["--version"],{cwd:e}),await execa("git",["init"],{cwd:e}),await execa("git",["add","-A"],{cwd:e}),await execa("git",["commit","-m","Initial commit"],{cwd:e}),r?.succeed("Creating a new Next.js monorepo.");}catch(i){r?.fail("Something went wrong creating a new Next.js monorepo."),Z(i);}}async function cn(e,t){let r=u("Creating a new Vite project. This may take a few minutes.").start();try{let i=E__default.join(it.tmpdir(),`shadcn-template-${Date.now()}`);await R.ensureDir(i);let n=await fetch(nt);if(!n.ok)throw new Error(`Failed to download template: ${n.statusText}`);let o=E__default.resolve(i,"template.tar.gz");await R.writeFile(o,Buffer.from(await n.arrayBuffer())),await execa("tar",["-xzf",o,"-C",i,"--strip-components=2","ui-main/templates/vite-app"]);let a=E__default.resolve(i,"vite-app");if(await R.move(a,e),await R.remove(i),t.packageManager!=="pnpm"){let c=E__default.join(e,"pnpm-lock.yaml");R.existsSync(c)&&await R.remove(c);}await execa(t.packageManager,["install"],{cwd:e});let s=E__default.join(e,"package.json");if(R.existsSync(s)){let c=await R.readFile(s,"utf8"),m=JSON.parse(c);m.name=e.split("/").pop(),await R.writeFile(s,JSON.stringify(m,null,2));}await execa("git",["--version"],{cwd:e}),await execa("git",["init"],{cwd:e}),await execa("git",["add","-A"],{cwd:e}),await execa("git",["commit","-m","Initial commit"],{cwd:e}),r?.succeed("Creating a new Vite project.");}catch(i){r?.fail("Something went wrong creating a new Vite project."),Z(i);}}async function ln(e,t){let r=u("Creating a new TanStack Start project. This may take a few minutes.").start();try{let i=E__default.join(it.tmpdir(),`shadcn-template-${Date.now()}`);await R.ensureDir(i);let n=await fetch(nt);if(!n.ok)throw new Error(`Failed to download template: ${n.statusText}`);let o=E__default.resolve(i,"template.tar.gz");await R.writeFile(o,Buffer.from(await n.arrayBuffer())),await execa("tar",["-xzf",o,"-C",i,"--strip-components=2","ui-main/templates/start-app"]);let a=E__default.resolve(i,"start-app");if(await R.move(a,e),await R.remove(i),t.packageManager!=="pnpm"){let c=E__default.join(e,"pnpm-lock.yaml");R.existsSync(c)&&await R.remove(c);}await execa(t.packageManager,["install"],{cwd:e});let s=E__default.join(e,"package.json");if(R.existsSync(s)){let c=await R.readFile(s,"utf8"),m=JSON.parse(c);m.name=e.split("/").pop(),await R.writeFile(s,JSON.stringify(m,null,2));}await execa("git",["--version"],{cwd:e}),await execa("git",["init"],{cwd:e}),await execa("git",["add","-A"],{cwd:e}),await execa("git",["commit","-m","Initial commit"],{cwd:e}),r?.succeed("Creating a new TanStack Start project.");}catch(i){r?.fail("Something went wrong creating a new TanStack Start project."),Z(i);}}async function B(e=process.cwd()){try{let{config:t}=await import('@dotenvx/dotenvx'),r=[".env.local",".env.development.local",".env.development",".env"];for(let i of r){let n=join(e,i);existsSync(n)&&t({path:n,overload:!1,quiet:!0});}}catch(t$1){t.warn("Failed to load env files:",t$1);}}var we=".bak";function hr(e){if(!R.existsSync(e))return null;let t=`${e}${we}`;try{return R.renameSync(e,t),t}catch(r){return console.error(`Failed to create backup of ${e}: ${r}`),null}}function wr(e){let t=`${e}${we}`;if(!R.existsSync(t))return  false;try{return R.renameSync(t,e),!0}catch(r){return console.error(`Warning: Could not restore backup file ${t}: ${r}`),false}}function ot(e){let t=`${e}${we}`;if(!R.existsSync(t))return  false;try{return R.unlinkSync(t),!0}catch{return  false}}async function yr(e,t){let r=new Set,i=new Set,n=[...e];for(;n.length>0;){let o=n.shift();if(i.has(o))continue;i.add(o);let{registry:a}=G(o);a&&!c$1[a]&&r.add(a);try{let[s]=await X([o],t,{useCache:!0});if(s?.registryDependencies)for(let c of s.registryDependencies){let{registry:m}=G(c);m&&!c$1[m]&&r.add(m),i.has(c)||n.push(c);}}catch(s){if(s instanceof A){let{registry:c}=G(o);c&&!c$1[c]&&r.add(c);continue}continue}}return Array.from(r)}async function T(e,t,r={}){r={silent:false,writeFile:true,...r};let n=(await yr(e,t)).filter(m=>!t.registries?.[m]&&!Object.keys(c$1).includes(m));if(n.length===0)return {config:t,newRegistries:[]};let o=await la({useCache:process.env.NODE_ENV!=="development"});if(!o)return {config:t,newRegistries:[]};let a={};for(let m of n)o[m]&&(a[m]=o[m]);if(Object.keys(a).length===0)return {config:t,newRegistries:[]};let s=Object.fromEntries(Object.entries(t.registries||{}).filter(([m])=>!Object.keys(c$1).includes(m))),c$2={...t,registries:{...s,...a}};if(r.writeFile){let{resolvedPaths:m,...l}=c$2,p=u("Updating components.json.",{silent:r.silent}).start(),g=c.parse(l);await R.writeFile(E__default.resolve(t.resolvedPaths.cwd,"components.json"),JSON.stringify(g,null,2)+`
`,"utf-8"),p.succeed();}return {config:c$2,newRegistries:Object.keys(a)}}async function xr(e$1,t,r){if(!e$1)return;r={silent:false,...r};let i=E__default.relative(t.resolvedPaths.cwd,t.resolvedPaths.tailwindConfig),n=u(`Updating ${e.info(i)}`,{silent:r.silent}).start(),o=await promises.readFile(t.resolvedPaths.tailwindConfig,"utf8"),a=await gn(o,e$1,t);await promises.writeFile(t.resolvedPaths.tailwindConfig,a,"utf8"),n?.succeed();}async function gn(e,t,r){let i=await V$1(e,r),n=i.getDescendantsOfKind(SyntaxKind.ObjectLiteralExpression).find(o=>o.getProperties().some(a=>a.isKind(SyntaxKind.PropertyAssignment)&&a.getName()==="content"));return n?(hn(n,t),i.getFullText()):e}async function hn(e,t){let r=W(e),i=e.getProperty("content");if(!i){let n={name:"content",initializer:`[${r}${t.join(`${r}, ${r}`)}${r}]`};return e.addPropertyAssignment(n),e}if(i.isKind(SyntaxKind.PropertyAssignment)){let n=i.getInitializer();if(n?.isKind(SyntaxKind.ArrayLiteralExpression))for(let o of t){let a=`${r}${o}${r}`;n.getElements().map(s=>s.getText()).includes(a)||n.addElement(a);}return e}return e}process.on("exit",e=>{let t=E__default.resolve(process.cwd(),"components.json");return e===0?ot(t):wr(t)});var at=z.object({cwd:z.string(),name:z.string().optional(),components:z.array(z.string()).optional(),yes:z.boolean(),defaults:z.boolean(),force:z.boolean(),silent:z.boolean(),isNewProject:z.boolean(),srcDir:z.boolean().optional(),cssVariables:z.boolean(),rtl:z.boolean().optional(),template:z.string().optional().refine(e=>e?V[e]:true,{message:"Invalid template. Please use 'next', 'vite', 'start' or 'next-monorepo'."}),baseColor:z.string().optional().refine(e=>e?b.find(t=>t.name===e):true,{message:`Invalid base color. Please use '${b.map(e=>e.name).join("', '")}'`}),baseStyle:z.boolean(),registryBaseConfig:c.deepPartial().optional()}),Sr=new Command().name("init").description("initialize your project and install dependencies").argument("[components...]","names, url or local path to component").option("-t, --template <template>","the template to use. (next, start, vite, next-monorepo)").option("-b, --base-color <base-color>","the base color to use. (neutral, gray, zinc, stone, slate)",void 0).option("-y, --yes","skip confirmation prompt.",true).option("-d, --defaults,","use default configuration.",false).option("-f, --force","force overwrite of existing configuration.",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-s, --silent","mute output.",false).option("--src-dir","use the src directory when creating a new project.",false).option("--no-src-dir","do not use the src directory when creating a new project.").option("--css-variables","use css variables for theming.",true).option("--no-css-variables","do not use css variables for theming.").option("--no-base-style","do not install the base shadcn style.").option("--rtl","enable RTL support.",false).action(async(e$1,t$1)=>{try{t$1.defaults&&(t$1.template=t$1.template||"next",t$1.baseColor=t$1.baseColor||"neutral");let r=at.parse({cwd:E__default.resolve(t$1.cwd),isNewProject:!1,components:e$1,...t$1});if(await B(r.cwd),e$1.length>0){let i=P(o({resolvedPaths:{cwd:r.cwd}})),n=E__default.resolve(r.cwd,"components.json");if(R.existsSync(n)){let s=await R.readJson(n),c$1=c.partial().parse(s),m=o({resolvedPaths:{cwd:r.cwd}});i=P({...c$1,resolvedPaths:{...m.resolvedPaths,cwd:r.cwd}}),hr(n);}let{config:o$1}=await T(e$1,i,{silent:!0,writeFile:!1});i=o$1,S(e$1[0],i);let[a]=await $([e$1[0]],{config:i});a?.type==="registry:base"&&(a.config&&(i=P(vr(i,a.config)),r.registryBaseConfig=a.config),r.baseStyle=a.extends==="none"?!1:r.baseStyle),a?.type==="registry:style"&&(r.baseColor="neutral",r.baseStyle=a.extends==="none"?!1:r.baseStyle);}r.baseStyle||(r.baseColor="neutral"),await me(r),t.log(`${e.success("Success!")} Project initialization completed.
You may now add components.`),ot(E__default.resolve(r.cwd,"components.json")),t.break();}catch(r){t.break(),Z(r);}finally{Q();}});async function me(e$1){let t,r$1;if(e$1.skipPreflight)t=await q(e$1.cwd);else {let w=await nr(e$1);if(w.errors["1"]){let{projectPath:u,template:h}=await Oe(e$1);u||process.exit(1),e$1.cwd=u,e$1.isNewProject=true,r$1=h,t=await q(e$1.cwd);}else t=w.projectInfo;}if(r$1==="next-monorepo")return e$1.cwd=E__default.resolve(e$1.cwd,"apps/web"),await j(e$1.cwd);let i=await r(e$1.cwd,t),n=i?await xn(i,e$1):await bn(await j(e$1.cwd));if(!e$1.yes){let{proceed:w}=await _e({type:"confirm",name:"proceed",message:`Write configuration to ${e.info("components.json")}. Proceed?`,initial:true});w||process.exit(0);}let o=[...e$1.baseStyle?["index"]:[],...e$1.components??[]],a=await k(e$1.cwd,n),{config:s}=await T(o,a,{silent:true});s.registries&&(n.registries=s.registries);let c=u("Writing components.json.").start(),m=E__default.resolve(e$1.cwd,"components.json"),l=`${m}${we}`,p=(w,u)=>{let{registries:h,...b}=vr(w,u);return {...b,registries:h}};if(!e$1.force&&R.existsSync(l)){let w=await R.readJson(l);n=p(w,n);}e$1.registryBaseConfig&&(n=p(n,e$1.registryBaseConfig)),e$1.rtl!==void 0&&(n.rtl=e$1.rtl),n.registries=Object.fromEntries(Object.entries(n.registries||{}).filter(([w])=>!Object.keys(c$1).includes(w))),await promises.writeFile(m,`${JSON.stringify(n,null,2)}
`,"utf8"),c.succeed();let g=await k(e$1.cwd,n);return await ie(o,g,{overwrite:true,silent:e$1.silent,baseStyle:e$1.baseStyle,isNewProject:e$1.isNewProject||t?.framework.name==="next-app"}),e$1.isNewProject&&e$1.srcDir&&await xr(["./src/**/*.{js,ts,jsx,tsx,mdx}"],g,{silent:e$1.silent}),g}async function bn(e$1=null){let[t$1,r]=await Promise.all([da(),fa()]);t.info("");let i$1=await _e([{type:"toggle",name:"typescript",message:`Would you like to use ${e.info("TypeScript")} (recommended)?`,initial:e$1?.tsx??true,active:"yes",inactive:"no"},{type:"select",name:"style",message:`Which ${e.info("style")} would you like to use?`,choices:t$1.map(n=>({title:n.label,value:n.name}))},{type:"select",name:"tailwindBaseColor",message:`Which color would you like to use as the ${e.info("base color")}?`,choices:r.map(n=>({title:n.label,value:n.name}))},{type:"text",name:"tailwindCss",message:`Where is your ${e.info("global CSS")} file?`,initial:e$1?.tailwind.css??h},{type:"toggle",name:"tailwindCssVariables",message:`Would you like to use ${e.info("CSS variables")} for theming?`,initial:e$1?.tailwind.cssVariables??true,active:"yes",inactive:"no"},{type:"text",name:"tailwindPrefix",message:`Are you using a custom ${e.info("tailwind prefix eg. tw-")}? (Leave blank if not)`,initial:""},{type:"text",name:"tailwindConfig",message:`Where is your ${e.info("tailwind.config.js")} located?`,initial:e$1?.tailwind.config??i},{type:"text",name:"components",message:`Configure the import alias for ${e.info("components")}:`,initial:e$1?.aliases.components??f},{type:"text",name:"utils",message:`Configure the import alias for ${e.info("utils")}:`,initial:e$1?.aliases.utils??g},{type:"toggle",name:"rsc",message:`Are you using ${e.info("React Server Components")}?`,initial:e$1?.rsc??true,active:"yes",inactive:"no"}]);return c.parse({$schema:"https://ui.shadcn.com/schema.json",style:i$1.style,tailwind:{config:i$1.tailwindConfig,css:i$1.tailwindCss,baseColor:i$1.tailwindBaseColor,cssVariables:i$1.tailwindCssVariables,prefix:i$1.tailwindPrefix},rsc:i$1.rsc,tsx:i$1.typescript,aliases:{utils:i$1.utils,components:i$1.components,lib:i$1.components.replace(/\/components$/,"lib"),hooks:i$1.components.replace(/\/components$/,"hooks")}})}async function xn(e$1,t){let r=e$1.style,i=t.baseColor,n=e$1.tailwind.cssVariables,o=e$1.iconLibrary??"lucide";if(!t.defaults){let[a,s$1,c]=await Promise.all([da(),fa(),s(e$1)]),m=await _e([{type:c==="v4"||r?null:"select",name:"style",message:`Which ${e.info("style")} would you like to use?`,choices:a.map(l=>({title:l.name==="new-york"?"New York (Recommended)":l.label,value:l.name})),initial:0},{type:t.baseColor?null:"select",name:"tailwindBaseColor",message:`Which color would you like to use as the ${e.info("base color")}?`,choices:s$1.map(l=>({title:l.label,value:l.name}))}]);r=m.style??r??"new-york",i=m.tailwindBaseColor??i,n=t.cssVariables;}return c.parse({$schema:e$1?.$schema,style:r,tailwind:{...e$1?.tailwind,baseColor:i,cssVariables:n},rsc:e$1?.rsc,tsx:e$1?.tsx,iconLibrary:o,rtl:t.rtl??e$1?.rtl??false,aliases:e$1?.aliases})}async function Cr(e$1){let t$1={};if(!R.existsSync(e$1.cwd)||!R.existsSync(E__default.resolve(e$1.cwd,"package.json")))return t$1["1"]=true,{errors:t$1,config:null};if(!R.existsSync(E__default.resolve(e$1.cwd,"components.json")))return t$1["3"]=true,{errors:t$1,config:null};try{let r=await j(e$1.cwd);return {errors:t$1,config:r}}catch{t.break(),t.error(`An invalid ${e.info("components.json")} file was found at ${e.info(e$1.cwd)}.
Before you can add components, you must create a valid ${e.info("components.json")} file by running the ${e.info("init")} command.`),t.error(`Learn more at ${e.info("https://ui.shadcn.com/docs/components-json")}.`),t.break(),process.exit(1);}}async function kr(e,t){let r=E__default.join(t.resolvedPaths.cwd,"app/page.tsx");if(!(await Y__default.stat(r)).isFile())return;let[i]=await $([e],{config:t});if(!i?.meta?.importSpecifier||!i?.meta?.moduleSpecifier)return;let n=`import { ${i?.meta?.importSpecifier} } from "${i.meta.moduleSpecifier}"

export default function Page() {
  return <${i?.meta?.importSpecifier} />
}`;await Y__default.writeFile(r,n,"utf8");}var Rn=z.object({components:z.array(z.string()).optional(),yes:z.boolean(),overwrite:z.boolean(),cwd:z.string(),all:z.boolean(),path:z.string().optional(),silent:z.boolean(),srcDir:z.boolean().optional(),cssVariables:z.boolean()}),jr=new Command().name("add").description("add a component to your project").argument("[components...]","names, url or local path to component").option("-y, --yes","skip confirmation prompt.",false).option("-o, --overwrite","overwrite existing files.",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-a, --all","add all available components",false).option("-p, --path <path>","the path to add the component to.").option("-s, --silent","mute output.",false).option("--src-dir","use the src directory when creating a new project.",false).option("--no-src-dir","do not use the src directory when creating a new project.").option("--css-variables","use css variables for theming.",true).option("--no-css-variables","do not use css variables for theming.").action(async(e$1,t$1)=>{try{let r=Rn.parse({components:e$1,cwd:E__default.resolve(t$1.cwd),...t$1});await B(r.cwd);let i=await j(r.cwd);i||(i=o({style:"new-york",resolvedPaths:{cwd:r.cwd}}));let n=["sidebar-","login-","signup-","otp-","calendar-"],o$1=["base-","radix-"];if(e$1.length>0&&i?.style&&o$1.some(b=>i?.style.startsWith(b))){let b=e$1.filter(v=>n.some(W=>v.startsWith(W)));b.length&&(t.warn(`The ${e.info(b.map(v=>v).join(", "))} component(s) are not available for the ${e.info(i.style)} style yet. They are coming soon.`),t.warn("In the meantime, you can visit the blocks page on https://ui.shadcn.com/blocks and copy the code."),t.break(),process.exit(1));}let a=!1;if(e$1.length>0){let{config:h,newRegistries:b}=await T(e$1,i,{silent:r.silent,writeFile:!1});i=h,a=b.length>0;}let s,c=!0;if(e$1.length>0){let[h]=await $([e$1[0]],{config:i});if(s=h?.type,c=s!=="registry:theme"&&s!=="registry:style",O(h)){await ie(e$1,i,{...r,baseStyle:c});return}if(!r.yes&&(s==="registry:style"||s==="registry:theme")){t.break();let{confirm:b}=await _e({type:"confirm",name:"confirm",message:e.warn(`You are about to install a new ${s.replace("registry:","")}. 
Existing CSS variables and components will be overwritten. Continue?`)});b||(t.break(),t.log("Installation cancelled."),t.break(),process.exit(1));}}if(r.components?.length||(r.components=await Cn(r)),(await q(r.cwd))?.tailwindVersion==="v4"){let h=d.filter(b=>r.components?.includes(b.name));h?.length&&(t.break(),h.forEach(b=>{t.warn(e.warn(b.message));}),t.break(),process.exit(1));}let{errors:l,config:p}=await Cr(r),g=!1;if(l["3"]){let{proceed:h}=await _e({type:"confirm",name:"proceed",message:`You need to create a ${e.info("components.json")} file to add components. Proceed?`,initial:!0});h||(t.break(),process.exit(1)),p=await me({cwd:r.cwd,yes:!0,force:!0,defaults:!1,skipPreflight:!1,silent:r.silent&&!a,isNewProject:!1,srcDir:r.srcDir,cssVariables:r.cssVariables,baseStyle:c,baseColor:c?void 0:"neutral",components:r.components}),g=!0;}let w=!1;if(l["1"]){let{projectPath:h,template:b}=await Oe({cwd:r.cwd,force:r.overwrite,srcDir:r.srcDir,components:r.components});h||(t.break(),process.exit(1)),r.cwd=h,b==="next-monorepo"?(r.cwd=E__default.resolve(r.cwd,"apps/web"),p=await j(r.cwd)):(p=await me({cwd:r.cwd,yes:!0,force:!0,defaults:!1,skipPreflight:!0,silent:!a&&r.silent,isNewProject:!0,srcDir:r.srcDir,cssVariables:r.cssVariables,baseStyle:c,baseColor:c?void 0:"neutral",components:r.components}),g=!0,w=r.components?.length===1&&!!r.components[0].match(/\/chat\/b\//));}if(!p)throw new Error(`Failed to read config at ${e.info(r.cwd)}.`);let{config:u}=await T(r.components,p,{silent:r.silent||a});p=u,g||await ie(r.components,p,{...r,baseStyle:c}),w&&await kr(r.components[0],p);}catch(r){t.break(),Z(r);}finally{Q();}});async function Cn(e){let t$1=await ca();if(!t$1)return t.break(),Z(new Error("Failed to fetch registry index.")),[];if(e.all)return t$1.map(n=>n.name).filter(n=>!d.some(o=>o.name===n));if(e.components?.length)return e.components;let{components:r}=await _e({type:"multiselect",name:"components",message:"Which components would you like to add?",hint:"Space to select. A to toggle all. Enter to submit.",instructions:false,choices:t$1.filter(n=>n.type==="registry:ui"&&!d.some(o=>o.name===n.name)).map(n=>({title:n.name,value:n.name,selected:e.all?true:e.components?.includes(n.name)}))});r?.length||(t.warn("No components selected. Exiting."),t.info(""),process.exit(1));let i=z.array(z.string()).safeParse(r);return i.success?i.data:(t.error(""),Z(new Error("Something went wrong. Please try again.")),[])}async function Nr(e$1){let t$1={},r={cwd:e$1.cwd,registryFile:E__default.resolve(e$1.cwd,e$1.registryFile),outputDir:E__default.resolve(e$1.cwd,e$1.outputDir)};return R.existsSync(r.registryFile)||(t$1["13"]=true),await R.mkdir(r.outputDir,{recursive:true}),Object.keys(t$1).length>0&&(t$1["13"]&&(t.break(),t.error(`The path ${e.info(r.registryFile)} does not exist.`)),t.break(),process.exit(1)),{errors:t$1,resolvePaths:r}}var kn=z.object({cwd:z.string(),registryFile:z.string(),outputDir:z.string()}),Or=new Command().name("build").description("build components for a shadcn registry").argument("[registry]","path to registry.json file","./registry.json").option("-o, --output <path>","destination directory for json files","./public/r").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async(e$1,t$1)=>{try{let r=kn.parse({cwd:E.resolve(t$1.cwd),registryFile:e$1,outputDir:t$1.output}),{resolvePaths:i}=await Nr(r),n$1=await Y.readFile(i.registryFile,"utf-8"),o=o$1.safeParse(JSON.parse(n$1));o.success||(t.error(`Invalid registry file found at ${e.info(i.registryFile)}.`),process.exit(1));let a=u("Building registry...");for(let s of o.data.items){a.start(`Building ${s.name}...`),s.$schema="https://ui.shadcn.com/schema/registry-item.json";for(let m of s.files??[])m.content=await Y.readFile(E.resolve(i.cwd,m.path),"utf-8");let c=n.safeParse(s);if(!c.success){t.error(`Invalid registry item found for ${e.info(s.name)}.`);continue}await Y.writeFile(E.resolve(i.outputDir,`${c.data.name}.json`),JSON.stringify(c.data,null,2));}await Y.copyFile(i.registryFile,E.resolve(i.outputDir,"registry.json")),a.succeed("Building registry.");}catch(r){t.break(),Z(r);}});var Fr=a.replace(/\/r\/?$/,""),En={next:"Next.js",vite:"Vite",start:"TanStack Start"},Ar=new Command().name("create").description("create a new project with shadcn/ui").argument("[name]","the name of your project").option("-t, --template <template>","the template to use. e.g. next, start or vite").option("-p, --preset [name]","use a preset configuration").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("--src-dir","use the src directory when creating a new project.",false).option("--no-src-dir","do not use the src directory when creating a new project.").option("-y, --yes","skip confirmation prompt.",true).option("--rtl","enable RTL support.",false).action(async(e$1,t$1)=>{try{if(!e$1&&!t$1.preset){let u={};t$1.template&&(u.template=t$1.template),t$1.rtl&&(u.rtl="true",u.base="base");let h=_r(Object.keys(u).length>0?u:void 0);t.log("Build your own shadcn/ui."),t.log(`You will be taken to ${e.info(h)} to build your custom design system.`),t.break();let{proceed:b}=await _e({type:"confirm",name:"proceed",message:"Open in browser?",initial:!0});b&&await Tr(h),process.exit(0);}let i=e$1;if(!i){let{enteredName:u}=await _e({type:"text",name:"enteredName",message:"What is your project named?",initial:t$1.template?`${t$1.template}-app`:"my-app",format:h=>h.trim(),validate:h=>jn(E__default.basename(E__default.resolve(h))).validForNewPackages?!0:"Invalid project name. Name should be lowercase, URL-friendly, and not start with a period or underscore."});u||process.exit(0),i=u;}let n=t$1.template;if(!n){let{selectedTemplate:u}=await _e({type:"select",name:"selectedTemplate",message:`Which ${e.info("template")} would you like to use?`,choices:Object.entries(En).map(([h,b])=>({title:b,value:h}))});u||process.exit(0),n=u;}let o=await Nn(t$1.preset??!0,t$1.rtl);o||process.exit(0);let a,s;if("_isUrl"in o){let u=new URL(o.url);t$1.rtl&&u.searchParams.set("rtl","true"),a=u.toString(),s=u.searchParams.get("baseColor")??"neutral";}else a=$n(o,t$1.rtl),s=o.baseColor;let c=P({}),{config:m}=await T([a],c,{silent:!0});c=m;let[l]=await $([a],{config:c}),p;l?.type==="registry:base"&&l.config&&(p=l.config);let g=at.parse({cwd:E__default.resolve(t$1.cwd),name:i,components:[a],yes:t$1.yes,defaults:!1,force:!1,silent:!1,isNewProject:!0,srcDir:t$1.srcDir,cssVariables:!0,rtl:t$1.rtl,template:n,baseColor:s,baseStyle:!1,registryBaseConfig:p,skipPreflight:!1}),w=await me(g);if(w){let u=["component-example"];t$1.rtl&&u.push("direction"),await ie(u,w,{baseStyle:!1,silent:!0,overwrite:!0});let h=On(n);h.length>0&&await L(h,w,{overwrite:!0,silent:!0});}t.log(`${e.success("Success!")} Project initialization completed.
You may now add components.`),t.break();}catch(r){t.break(),Z(r);}finally{Q();}});function $n(e,t){let r=new URLSearchParams({base:e.base,style:e.style,baseColor:e.baseColor,theme:e.theme,iconLibrary:e.iconLibrary,font:e.font,rtl:String(t||e.rtl),menuAccent:e.menuAccent,menuColor:e.menuColor,radius:e.radius});return `${Tn()}?${r.toString()}`}async function Nn(e$1,t$1){if(e$1===true){let r=await ma(),{selectedPreset:i}=await _e({type:"select",name:"selectedPreset",message:`Which ${e.info("preset")} would you like to use?`,choices:[...r.map(n=>({title:n.title,description:n.description,value:n.name})),{title:"Custom",description:"Build your own on https://ui.shadcn.com",value:"custom"}]});if(!i)return null;if(i==="custom"){let n=_r(t$1?{rtl:"true"}:void 0);return t.info(`
Opening ${e.info(n)} in your browser...
`),await Tr(n),null}return r.find(n=>n.name===i)??null}if(typeof e$1=="string"){if(N(e$1))return {_isUrl:true,url:e$1};let r=await na(e$1);if(!r){let n=(await ma()).map(o=>o.name).join(", ");t.error(`Preset "${e$1}" not found. Available presets: ${n}`),process.exit(1);}return r}return null}function On(e){switch(e){case "vite":return [{type:"registry:file",path:"src/App.tsx",target:"src/App.tsx",content:ft`import { ComponentExample } from "@/components/component-example";

export function App() {
  return <ComponentExample />;
}

export default App;
`}];case "next":return [{type:"registry:page",path:"app/page.tsx",target:"app/page.tsx",content:ft`import { ComponentExample } from "@/components/component-example";

export default function Page() {
  return <ComponentExample />;
}
`}];case "start":return [{type:"registry:file",path:"src/routes/index.tsx",target:"src/routes/index.tsx",content:ft`import { createFileRoute } from "@tanstack/react-router";
import { ComponentExample } from "@/components/component-example";

export const Route = createFileRoute("/")({ component: App });

function App() {
  return (
    <ComponentExample />
  );
}
`}];default:return []}}function _r(e){let t=new URL(`${Fr}/create`);if(e)for(let[r,i]of Object.entries(e))t.searchParams.set(r,i);return t.toString()}function Tn(){return `${Fr}/init`}var Dn=z.object({component:z.string().optional(),yes:z.boolean(),cwd:z.string(),path:z.string().optional()}),Lr=new Command().name("diff").description("check for updates against the registry").argument("[component]","the component name").option("-y, --yes","skip confirmation prompt.",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async(e$1,t$1)=>{try{let r=Dn.parse({component:e$1,...t$1}),i=E__default.resolve(r.cwd);existsSync(i)||(t.error(`The path ${i} does not exist. Please try again.`),process.exit(1));let n=await j(i);n||(t.warn(`Configuration is missing. Please run ${e.success("init")} to create a components.json file.`),process.exit(1));let o=await ca();if(o||(Z(new Error("Failed to fetch registry index.")),process.exit(1)),!r.component){let c=n.resolvedPaths.components,m=o.filter(p=>{for(let g of p.files??[]){let w=E__default.resolve(c,typeof g=="string"?g:g.path);if(existsSync(w))return !0}return !1}),l=[];for(let p of m){let g=await Dr(p,n);g.length&&l.push({name:p.name,changes:g});}l.length||(t.info("No updates found."),process.exit(0)),t.info("The following components have updates available:");for(let p of l){t.info(`- ${p.name}`);for(let g of p.changes)t.info(`  - ${g.filePath}`);}t.break(),t.info(`Run ${e.success("diff <component>")} to see the changes.`),process.exit(0);}let a=o.find(c=>c.name===r.component);a||(t.error(`The component ${e.success(r.component)} does not exist.`),process.exit(1));let s=await Dr(a,n);s.length||(t.info(`No updates found for ${r.component}.`),process.exit(0));for(let c of s)t.info(`- ${c.filePath}`),await Ln(c.patch),t.info("");}catch(r){Z(r);}});async function Dr(e,t){let r=await ia(t.style,[e]),i=await ga(t.tailwind.baseColor);if(!r)return [];let n=[];for(let o of r){let a=await ja(t,o);if(a)for(let s of o.files??[]){let c=E__default.resolve(a,typeof s=="string"?s:s.path);if(!existsSync(c))continue;let m=await promises.readFile(c,"utf8");if(typeof s=="string"||!s.content)continue;let l=await K({filename:s.path,raw:s.content,config:t,baseColor:i}),p=diffLines(l,m);p.length>1&&n.push({filePath:c,patch:p});}}return n}async function Ln(e$1){e$1.forEach(t=>{if(t)return t.added?process.stdout.write(e.success(t.value)):t.removed?process.stdout.write(e.error(t.value)):process.stdout.write(t.value)});}var Vr=new Command().name("info").description("get information about your project").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async e=>{try{t.info("> project info"),console.log(await q(e.cwd)),t.break(),t.info("> components.json"),console.log(await j(e.cwd));}catch(t){Z(t);}});var oe="latest",Le=[{name:"claude",label:"Claude Code",configPath:".mcp.json",config:{mcpServers:{shadcn:{command:"npx",args:[`shadcn@${oe}`,"mcp"]}}}},{name:"cursor",label:"Cursor",configPath:".cursor/mcp.json",config:{mcpServers:{shadcn:{command:"npx",args:[`shadcn@${oe}`,"mcp"]}}}},{name:"vscode",label:"VS Code",configPath:".vscode/mcp.json",config:{servers:{shadcn:{command:"npx",args:[`shadcn@${oe}`,"mcp"]}}}},{name:"codex",label:"Codex",configPath:".codex/config.toml",config:`[mcp_servers.shadcn]
command = "npx"
args = ["shadcn@${oe}", "mcp"]
`},{name:"opencode",label:"OpenCode",configPath:"opencode.json",config:{$schema:"https://opencode.ai/config.json",mcp:{shadcn:{type:"local",command:["npx",`shadcn@${oe}`,"mcp"],enabled:true}}}}],De=[`shadcn@${oe}`],gt=new Command().name("mcp").description("MCP server and configuration commands").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async e=>{try{await B(e.cwd);let t=new StdioServerTransport;await b$1.connect(t);}catch(t$1){t.break(),Z(t$1);}}),Gn=ut.object({client:ut.enum(["claude","cursor","vscode","codex","opencode"]),cwd:ut.string()});gt.command("init").description("Initialize MCP configuration for your client").option("--client <client>",`MCP client (${Le.map(e=>e.name).join(", ")})`).action(async(e$1,t$1)=>{try{let i=(t$1.parent?.opts()||{}).cwd||process.cwd(),n=e$1.client;if(!n){let m=await _e({type:"select",name:"client",message:"Which MCP client are you using?",choices:Le.map(l=>({title:l.label,value:l.name}))});m.client||(t.break(),process.exit(1)),n=m.client;}let o=Gn.parse({client:n,cwd:i}),a=await j(o.cwd);if(o.client==="codex"){if(a)await U([],De,a,{silent:!1});else {let m=await a$1(o.cwd),l=m==="npm"?"install":"add",p=m==="npm"?"--save-dev":"-D",g=u("Installing dependencies...").start();await execa(m,[l,p,...De],{cwd:o.cwd}),g.succeed("Installing dependencies.");}t.break(),t.log("To configure the shadcn MCP server in Codex:"),t.break(),t.log(`1. Open or create the file ${e.info("~/.codex/config.toml")}`),t.log("2. Add the following configuration:"),t.log(),t.info(`[mcp_servers.shadcn]
command = "npx"
args = ["shadcn@${oe}", "mcp"]`),t.break(),t.info("3. Restart Codex to load the MCP server"),t.break(),process.exit(0);}let s=u("Configuring MCP server...").start(),c=await Yn(o);if(s.succeed("Configuring MCP server."),a)await U([],De,a,{silent:!1});else {let m=await a$1(o.cwd),l=m==="npm"?"install":"add",p=m==="npm"?"--save-dev":"-D",g=u("Installing dependencies...").start();await execa(m,[l,p,...De],{cwd:o.cwd}),g.succeed("Installing dependencies.");}t.break(),t.success(`Configuration saved to ${c}.`),t.break();}catch(r){Z(r);}});var Jn=(e,t)=>t;async function Yn(e){let{client:t,cwd:r}=e,i=Le.find(c=>c.name===t);if(!i)throw new Error(`Unknown client: ${t}. Available clients: ${Le.map(c=>c.name).join(", ")}`);let n=E__default.join(r,i.configPath),o=E__default.dirname(n);await R.ensureDir(o);let a={};try{let c=await promises.readFile(n,"utf-8");a=JSON.parse(c);}catch{}let s=vr(a,i.config,{arrayMerge:Jn});return await promises.writeFile(n,JSON.stringify(s,null,2)+`
`,"utf-8"),i.configPath}var H={lucide:{name:"lucide-react",package:"lucide-react",import:"lucide-react"},radix:{name:"@radix-ui/react-icons",package:"@radix-ui/react-icons",import:"@radix-ui/react-icons"}};async function Br(e$1){if(!e$1.resolvedPaths.ui)throw new Error("We could not find a valid `ui` path in your `components.json` file. Please ensure you have a valid `ui` path in your `components.json` file.");let t$1=e$1.resolvedPaths.ui,[r,i]=await Promise.all([bt("**/*.{js,ts,jsx,tsx}",{cwd:t$1}),ea()]);if(Object.keys(i).length===0)throw new Error("Something went wrong fetching the registry icons.");let n=Object.entries(H).map(([l,p])=>({title:p.name,value:l})),o=await _e([{type:"select",name:"sourceLibrary",message:`Which icon library would you like to ${e.info("migrate from")}?`,choices:n},{type:"select",name:"targetLibrary",message:`Which icon library would you like to ${e.info("migrate to")}?`,choices:n}]);if(o.sourceLibrary===o.targetLibrary)throw new Error("You cannot migrate to the same icon library. Please choose a different icon library.");if(!(o.sourceLibrary in H&&o.targetLibrary in H))throw new Error("Invalid icon library. Please choose a valid icon library.");let a=H[o.sourceLibrary],s=H[o.targetLibrary],{confirm:c}=await _e({type:"confirm",name:"confirm",initial:true,message:`We will migrate ${e.info(r.length)} files in ${e.info(`./${E__default.relative(e$1.resolvedPaths.cwd,t$1)}`)} from ${e.info(a.name)} to ${e.info(s.name)}. Continue?`});c||(t.info("Migration cancelled."),process.exit(0)),s.package&&await U([s.package],[],e$1,{silent:false});let m=u("Migrating icons...")?.start();await Promise.all(r.map(async l=>{m.text=`Migrating ${l}...`;let p=E__default.join(t$1,l),g=await promises.readFile(p,"utf-8"),w=await eo(g,o.sourceLibrary,o.targetLibrary,i);await promises.writeFile(p,w);})),m.succeed("Migration complete.");}async function eo(e,t,r,i){let n=H[t]?.import,o=H[r]?.import,a=await promises.mkdtemp(E__default.join(tmpdir(),"shadcn-")),s=new Project({compilerOptions:{}}),c=E__default.join(a,`shadcn-icons-${randomBytes(4).toString("hex")}.tsx`),m=s.createSourceFile(c,e,{scriptKind:ScriptKind.TSX}),l=[];for(let p of m.getImportDeclarations()??[])if(p.getModuleSpecifier()?.getText()===`"${n}"`){for(let g of p.getNamedImports()??[]){let w=g.getName(),u=Object.values(i).find(h=>h[t]===w)?.[r];!u||l.includes(u)||(l.push(u),g.remove(),m.getDescendantsOfKind(SyntaxKind.JsxSelfClosingElement).filter(h=>h.getTagNameNode()?.getText()===w).forEach(h=>h.getTagNameNode()?.replaceWithText(u)));}p.getNamedImports()?.length===0&&p.remove();}return l.length>0&&m.addImportDeclaration({moduleSpecifier:o,namedImports:l.map(p=>({name:p}))}),await m.getText()}function io(e){return e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join("")}function no(e,t,r,i){let o=e.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ").trim().split(",").map(a=>a.trim()).filter(Boolean);for(let a of o){let s=a.match(/^type\s+(\w+)(?:\s+as\s+(\w+))?$/),c=a.match(/^(\w+)\s+as\s+(\w+)$/);if(s){let m=s[1],l=s[2];i==="slot"&&m==="Slot"&&!l?r.push({name:"Slot",alias:"SlotPrimitive",isType:true}):r.push({name:m,alias:l,isType:true});}else if(c){let m=c[1],l=c[2];i==="slot"&&m==="Slot"&&l==="Slot"?r.push({name:"Slot",alias:"SlotPrimitive",isType:t}):r.push({name:m,alias:l,isType:t});}else i==="slot"&&a==="Slot"?r.push({name:"Slot",alias:"SlotPrimitive",isType:t}):r.push({name:a,isType:t});}}async function Gr(e$1,t$1={}){if(!e$1.resolvedPaths.ui)throw new Error("We could not find a valid `ui` path in your `components.json` file. Please ensure you have a valid `ui` path in your `components.json` file.");let r=e$1.resolvedPaths.ui,i=await bt("**/*.{js,ts,jsx,tsx}",{cwd:r});if(!t$1.yes){let{confirm:s}=await _e({type:"confirm",name:"confirm",initial:true,message:`We will migrate ${e.info(i.length)} files in ${e.info(`./${E__default.relative(e$1.resolvedPaths.cwd,r)}`)} to ${e.info("radix-ui")}. Continue?`});s||(t.info("Migration cancelled."),process.exit(0));}let n=u("Migrating imports...")?.start(),o=new Set;await Promise.all(i.map(async s=>{n.text=`Migrating ${s}...`;let c=E__default.join(r,s),m=await promises.readFile(c,"utf-8"),{content:l,replacedPackages:p}=await oo(m);p.forEach(g=>o.add(g)),await promises.writeFile(c,l);})),n.succeed("Migrating imports.");let a=u("Updating package.json...")?.start();try{let s=p(e$1.resolvedPaths.cwd,!1);if(!s){a.fail("Could not read package.json"),t.warn("Could not update package.json. You may need to manually replace @radix-ui/react-* packages with radix-ui");return}let c=Array.from(o),m=["dependencies","devDependencies"];for(let l of m)if(s[l])for(let p of c)s[l][p]&&delete s[l][p];if(c.length>0){s.dependencies||(s.dependencies={}),s.dependencies["radix-ui"]="latest";let l=E__default.join(e$1.resolvedPaths.cwd,"package.json");await promises.writeFile(l,JSON.stringify(s,null,2)+`
`),a.succeed("Updated package.json."),await U(["radix-ui"],[],e$1,{silent:!1});}else a.succeed("No packages found in source files.");}catch{a.fail("Failed to update package.json"),t.warn("You may need to manually replace @radix-ui/react-* packages with radix-ui");}}async function oo(e){let t=/import\s+(?:(type)\s+)?(?:\*\s+as\s+(\w+)|{([^}]+)})\s+from\s+(["'])@radix-ui\/react-([^"']+)\4(;?)/g,r=[],i=[],n=[],o='"',a=false,s=e,c;for(;(c=t.exec(e))!==null;){let[u,h,b,v,W,F,X]=c;if(F==="icons"||F.startsWith("icons/"))continue;i.push(u),i.length===1&&(o=W,a=X===";"),n.push(`@radix-ui/react-${F}`);let A=!!h;if(b){let Me=io(F);r.push({name:Me,alias:b,isType:A});}else v&&no(v,A,r,F);}if(r.length===0)return {content:e,replacedPackages:[]};let m=r.filter((u,h,b)=>h===b.findIndex(v=>v.name===u.name&&v.alias===u.alias&&v.isType===u.isType)),p=`import { ${m.map(u=>{let h=u.isType?"type ":"";return u.alias?`${h}${u.name} as ${u.alias}`:`${h}${u.name}`}).join(", ")} } from ${o}radix-ui${o}${a?";":""}`;s=i.reduce((u,h,b)=>u.replace(h,b===0?p:""),s),s=s.replace(/\n\s*\n\s*\n/g,`

`),m.some(u=>u.name==="Slot"&&u.alias==="SlotPrimitive")&&(s=s.split(`
`).map(b=>{if(b.trim().startsWith("import "))return b;let v=b;return v=v.replace(/\b(asChild\s*\?\s*)Slot(\s*:)/g,"$1__SLOT_PLACEHOLDER__$2"),v=v.replace(/\bReact\.ComponentProps<typeof\s+Slot>/g,"React.ComponentProps<typeof __SLOT_PLACEHOLDER__>"),v=v.replace(/\bComponentProps<typeof\s+Slot>/g,"ComponentProps<typeof __SLOT_PLACEHOLDER__>"),v=v.replace(/(<\/?)Slot(\s*\/?>)/g,"$1__SLOT_PLACEHOLDER__$2"),v=v.replace(/\bSlot\b/g,(W,F,X)=>{let A=X.substring(0,F),Me=(A.match(/"/g)||[]).length,fi=(A.match(/'/g)||[]).length;return Me%2!==0||fi%2!==0?W:"__SLOT_PLACEHOLDER__"}),v=v.replace(/__SLOT_PLACEHOLDER__/g,"SlotPrimitive.Slot"),v}).join(`
`));let w=Array.from(new Set(n));return {content:s,replacedPackages:w}}var ao=["sidebar.tsx","pagination.tsx","calendar.tsx"],co="https://ui.shadcn.com/docs/rtl#manual-migration-optional";async function Jr(e$2,t$1={}){let r,i;if(t$1.path){if(i=e$2.resolvedPaths.cwd,t$1.path.includes("*"))r=await bt(t$1.path,{cwd:i,onlyFiles:true,ignore:["**/node_modules/**"]});else {let m=E__default.resolve(i,t$1.path),l=await promises.stat(m).catch(()=>null);if(!l)throw new Error(`File not found: ${t$1.path}`);if(l.isDirectory())i=m,r=await bt("**/*.{js,ts,jsx,tsx}",{cwd:i,onlyFiles:true,ignore:["**/node_modules/**"]});else if(l.isFile())r=[t$1.path];else throw new Error(`Unsupported path type: ${t$1.path}`)}if(r.length===0)throw new Error(`No files found matching: ${t$1.path}`)}else {if(!e$2.resolvedPaths.ui)throw new Error("Could not find a valid `ui` path in your `components.json`. Please provide a path or glob pattern.");i=e$2.resolvedPaths.ui,r=await bt("**/*.{js,ts,jsx,tsx}",{cwd:i,onlyFiles:true});}if(!t$1.yes){let c=t$1.path?t$1.path:`./${E__default.relative(e$2.resolvedPaths.cwd,i)}`,{confirm:m}=await _e({type:"confirm",name:"confirm",initial:true,message:`We will migrate ${e.info(r.length)} file(s) in ${e.info(c)} to RTL. Continue?`});m||(t.info("Migration cancelled."),process.exit(0));}let n=u("Updating components.json...").start();try{let c=E__default.resolve(e$2.resolvedPaths.cwd,"components.json"),m=JSON.parse(await promises.readFile(c,"utf-8"));m.rtl=!0,await promises.writeFile(c,JSON.stringify(m,null,2)+`
`),n.succeed("Updated components.json.");}catch{throw n.fail("Failed to update components.json."),new Error("Could not update components.json. Please manually set `rtl: true`.")}let o=u("Migrating files to RTL...").start(),a=0,s=[];if(await Promise.all(r.map(async c=>{o.text=`Migrating ${c}...`;let m=E__default.join(i,c),l=await promises.readFile(m,"utf-8"),p=await e$1(l,true);p!==l&&(await promises.writeFile(m,p),a++);let g=E__default.basename(c);ao.includes(g)&&s.push(c);})),o.succeed(`Migration complete. ${a} file(s) transformed.`),s.length>0){t.break(),t.warn("The following components may need manual RTL adjustments:");for(let c of s)t.info(`  - ${c}`);t.break(),t.info(`See ${e.info(co)} for more information.`);}}async function Kr(e$1){let t$1={};if(!R.existsSync(e$1.cwd)||!R.existsSync(E__default.resolve(e$1.cwd,"package.json")))return t$1["1"]=true,{errors:t$1,config:null};if(!R.existsSync(E__default.resolve(e$1.cwd,"components.json")))return t$1["3"]=true,{errors:t$1,config:null};try{let r=await j(e$1.cwd);return {errors:t$1,config:r}}catch{t.break(),t.error(`An invalid ${e.info("components.json")} file was found at ${e.info(e$1.cwd)}.
Before you can run a migration, you must create a valid ${e.info("components.json")} file by running the ${e.info("init")} command.`),t.error(`Learn more at ${e.info("https://ui.shadcn.com/docs/components-json")}.`),t.break(),process.exit(1);}}var qr=[{name:"icons",description:"migrate your ui components to a different icon library."},{name:"radix",description:"migrate to radix-ui."},{name:"rtl",description:"migrate your components to support RTL (right-to-left)."}],fo=z.object({cwd:z.string(),list:z.boolean(),yes:z.boolean(),migration:z.string().refine(e=>e&&qr.some(t=>t.name===e),{message:"You must specify a valid migration. Run `shadcn migrate --list` to see available migrations."}).optional(),path:z.string().optional()}),Hr=new Command().name("migrate").description("run a migration.").argument("[migration]","the migration to run.").argument("[path]","optional path or glob pattern to migrate.").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-l, --list","list all migrations.",false).option("-y, --yes","skip confirmation prompt.",false).action(async(e,t$1,r)=>{try{let i=fo.parse({cwd:E__default.resolve(r.cwd),migration:e,path:t$1,list:r.list,yes:r.yes});if(i.list||!i.migration){t.info("Available migrations:");for(let a of qr)t.info(`- ${a.name}: ${a.description}`);return}if(!i.migration)throw new Error("You must specify a migration. Run `shadcn migrate --list` to see available migrations.");let{errors:n,config:o}=await Kr(i);if(n["1"]||n["3"])throw new Error("No `components.json` file found. Ensure you are at the root of your project.");if(!o)throw new Error("Something went wrong reading your `components.json` file. Please ensure you have a valid `components.json` file.");i.migration==="icons"&&await Br(o),i.migration==="radix"&&await Gr(o,{yes:i.yes}),i.migration==="rtl"&&await Jr(o,{yes:i.yes,path:i.path});}catch(i){t.break(),Z(i);}});var go=z.object({cwd:z.string(),silent:z.boolean()}),Qr=new Command().name("add").description("add registries to your project").argument("[registries...]","registries (@namespace) or registry URLs (@namespace=url)").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-s, --silent","mute output.",false).action(async(e,t$1)=>{try{let r=go.parse({cwd:E__default.resolve(t$1.cwd),silent:t$1.silent}),i=e.length>0?e:await yo({silent:r.silent});await wo(i,r.cwd,{silent:r.silent});}catch(r){t.break(),Z(r);}});function ho(e$1){let[t,...r]=e$1.split("="),i=r.length>0?r.join("="):void 0;if(!t.startsWith("@"))throw new Error(`Invalid registry namespace: ${e.info(t)}. Registry names must start with @ (e.g., @acme).`);return {namespace:t,url:i}}function Rt(e,t,r){return `${e} ${e===1?t:r}`}async function wo(e$1,t$1,r){let i=E__default.resolve(t$1,"components.json");if(!R.existsSync(i))throw new Error(`No ${e.info("components.json")} found. Run ${e.info("shadcn init")} first.`);let n=e$1.map(ho),o=n.filter(u=>!u.url),a=[];if(o.length>0){let u$1=u("Fetching registries.",{silent:r.silent}).start(),h=await ka();if(!h)throw u$1.fail(),new Error("Failed to fetch registries.");u$1.succeed(),a=h;}let s={};for(let{namespace:u,url:h}of n){if(u in c$1){t.warn(`${e.info(u)} is a built-in registry and cannot be added.`);continue}if(h){if(!h.includes("{name}"))throw new Error(`Invalid registry URL for ${e.info(u)}. URL must include {name} placeholder. Example: ${e.info(`${u}=https://example.com/r/{name}.json`)}`);s[u]=h;}else {let b=a.find(v=>v.name===u);if(!b)throw new Error(`Registry ${e.info(u)} not found. Provide a URL: ${e.info(`${u}=https://.../{name}.json`)}`);s[u]=b.url;}}if(Object.keys(s).length===0)return {addedRegistries:[]};let c=await R.readJson(i),m=c.registries||{},l={},p=[];for(let[u,h]of Object.entries(s))m[u]?p.push(u):l[u]=h;if(Object.keys(l).length===0){if(p.length>0&&!r.silent){u(`Skipped ${Rt(p.length,"registry","registries")}: (already configured)`,{silent:r.silent})?.info();for(let u of p)t.log(`  - ${u}`);}else r.silent||t.info("No new registries to add.");return}let g={...c,registries:{...m,...l}},w=u("Updating components.json.",{silent:r.silent}).start();if(await R.writeJson(i,g,{spaces:2}),w.succeed(),!r.silent){let u$1=Object.keys(l);u(`Added ${Rt(u$1.length,"registry","registries")}:`,{silent:r.silent})?.succeed();for(let h of u$1)t.log(`  - ${h}`);if(p.length>0){u(`Skipped ${Rt(p.length,"registry","registries")}: (already configured)`,{silent:r.silent})?.info();for(let h of p)t.log(`  - ${h}`);}}}async function yo(e){let t$1=u("Fetching registries.",{silent:e.silent}).start(),r=await ka();if(!r)throw t$1.fail(),new Error("Failed to fetch registries.");t$1.succeed();let i=[...r].sort((o,a)=>o.name.localeCompare(a.name)),{selected:n}=await _e({type:"autocompleteMultiselect",name:"selected",message:"Which registries would you like to add?",hint:"Space to select. A to toggle all. Enter to submit.",instructions:false,choices:i.map(o=>({title:o.name,description:o.description,value:o.name}))});return n?.length||(t.warn("No registries selected. Exiting."),t.info(""),process.exit(1)),n}var Zr=new Command().name("registry").description("manage registries").addCommand(Qr);async function ei(e$1){let t$1={},r={cwd:e$1.cwd,registryFile:E__default.resolve(e$1.cwd,e$1.registryFile),outputDir:E__default.resolve(e$1.cwd,e$1.outputDir)};if(!R.existsSync(r.registryFile))return t$1["13"]=true,{errors:t$1,resolvePaths:null,config:null};if(!R.existsSync(E__default.resolve(e$1.cwd,"components.json")))return t$1["3"]=true,{errors:t$1,resolvePaths:null,config:null};await R.mkdir(r.outputDir,{recursive:true});try{let i=await j(e$1.cwd);return {errors:t$1,config:i,resolvePaths:r}}catch{t.break(),t.error(`An invalid ${e.info("components.json")} file was found at ${e.info(e$1.cwd)}.
Before you can build the registry, you must create a valid ${e.info("components.json")} file by running the ${e.info("init")} command.`),t.break(),process.exit(1);}}var vo=z.object({cwd:z.string(),registryFile:z.string(),outputDir:z.string(),verbose:z.boolean().optional().default(false)}),ti=new Command().name("registry:build").description("builds the registry [EXPERIMENTAL]").argument("[registry]","path to registry.json file","./registry.json").option("-o, --output <path>","destination directory for json files","./public/r").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-v, --verbose","verbose output").action(async(e,t)=>{await So({cwd:E.resolve(t.cwd),registryFile:e,outputDir:t.output,verbose:t.verbose});});async function So(e$1){try{let t$1=vo.parse(e$1),[{errors:r,resolvePaths:i,config:n$1},o]=await Promise.all([ei(t$1),q(t$1.cwd)]);(r["3"]||!n$1||!o)&&(t.error(`A ${e.info("components.json")} file is required to build the registry. Run ${e.info("shadcn init")} to create one.`),t.break(),process.exit(1)),(r["13"]||!i)&&(t.error(`We could not find a registry file at ${e.info(E.resolve(t$1.cwd,t$1.registryFile))}.`),t.break(),process.exit(1));let a=await Y.readFile(i.registryFile,"utf-8"),s=o$1.safeParse(JSON.parse(a));s.success||(t.error(`Invalid registry file found at ${e.info(i.registryFile)}.`),t.break(),process.exit(1));let c=u("Building registry..."),m=await Ro(s.data,n$1,o);for(let l of m.items)l.files=l.files?.filter((p,g,w)=>g===w.findIndex(u=>u.path===p.path)),l.dependencies&&(l.dependencies=l.dependencies.filter((p,g,w)=>g===w.findIndex(u=>u===p)));for(let l of m.items){if(!l.files)continue;c.start(`Building ${l.name}...`),l.$schema="https://ui.shadcn.com/schema/registry-item.json";for(let g of l.files){let w=E.resolve(i.cwd,g.path);try{if(!(await Y.stat(w)).isFile())continue;g.content=await Y.readFile(w,"utf-8");}catch(u){console.error("Error reading file in registry build:",w,u);continue}}let p=n.safeParse(l);if(!p.success){t.error(`Invalid registry item found for ${e.info(l.name)}.`);continue}await Y.writeFile(E.resolve(i.outputDir,`${p.data.name}.json`),JSON.stringify(p.data,null,2));}if(await Y.copyFile(i.registryFile,E.resolve(i.outputDir,"registry.json")),c.succeed("Building registry."),t$1.verbose){u(`The registry has ${e.info(m.items.length.toString())} items:`).succeed();for(let l of m.items){t.log(`  - ${l.name} (${e.info(l.type)})`);for(let p of l.files??[])t.log(`    - ${p.path}`);}}}catch(t$1){t.break(),Z(t$1);}}async function Ro(e,t,r){for(let i of e.items)if(i.files?.length)for(let n of i.files){let o=await M(n.path,t,r);o.files=o.files?.filter(a=>a.path!==n.path),o.files&&i.files.push(...o.files),o.dependencies&&(i.dependencies=i.dependencies?i.dependencies.concat(o.dependencies):o.dependencies);}return e}var ri=new Command().name("registry:mcp").description("starts the registry MCP server [DEPRECATED]").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async()=>{t.warn(`The ${e.info("shadcn registry:mcp")} command is deprecated. Use the ${e.info("shadcn mcp")} command instead.`),t.break();});var ko=z.object({cwd:z.string(),query:z.string().optional(),limit:z.number().optional(),offset:z.number().optional()}),oi=new Command().name("search").alias("list").description("search items from registries").argument("<registries...>","the registry names or urls to search items from. Names must be prefixed with @.").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-q, --query <query>","query string").option("-l, --limit <number>","maximum number of items to display per registry","100").option("-o, --offset <number>","number of items to skip","0").action(async(e,t)=>{try{let r=ko.parse({cwd:E__default.resolve(t.cwd),query:t.query,limit:t.limit?parseInt(t.limit,10):void 0,offset:t.offset?parseInt(t.offset,10):void 0});await B(r.cwd);let i=o({style:"new-york",resolvedPaths:{cwd:r.cwd}}),n=P(i),o$1=E__default.resolve(r.cwd,"components.json");if(R.existsSync(o$1)){let l=await R.readJson(o$1),p=c.partial().parse(l);n=P({...i,...p});}let a=n;try{let l=await j(r.cwd);l&&(a=P(l));}catch{}let{config:s,newRegistries:c$1}=await T(e.map(l=>`${l}/registry`),a,{silent:!0,writeFile:!1});c$1.length>0&&(a.registries=s.registries),R$1(e,a);let m=await oa(e,{query:r.query,limit:r.limit,offset:r.offset,config:a});console.log(JSON.stringify(m,null,2)),process.exit(0);}catch(r){Z(r);}finally{Q();}});var jo=z.object({cwd:z.string()}),li=new Command().name("view").description("view items from the registry").argument("<items...>","the item names or URLs to view").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async(e,t)=>{try{let r=jo.parse({cwd:E__default.resolve(t.cwd)});await B(r.cwd);let i=P({}),n=E__default.resolve(r.cwd,"components.json");if(R.existsSync(n)){let m=await R.readJson(n),l=c.partial().parse(m);i=P(l);}let o=i;try{let m=await j(r.cwd);m&&(o=P(m));}catch{}let{config:a,newRegistries:s}=await T(e,o,{silent:!0,writeFile:!1});s.length>0&&(o.registries=a.registries),R$1(e,o);let c$1=await $(e,{config:o});console.log(JSON.stringify(c$1,null,2)),process.exit(0);}catch(r){Z(r);}finally{Q();}});var mi={version:"3.8.1"};process.on("SIGINT",()=>process.exit(0));process.on("SIGTERM",()=>process.exit(0));async function No(){let e=new Command().name("shadcn").description("add items from registries to your project").version(mi.version,"-v, --version","display the version number");e.addCommand(Sr).addCommand(Ar).addCommand(jr).addCommand(Lr).addCommand(li).addCommand(oi).addCommand(Hr).addCommand(Vr).addCommand(Or).addCommand(gt).addCommand(Zr),e.addCommand(ti).addCommand(ri),e.parse();}No();//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map